<!DOCTYPE html>
<!-- saved from url=(0111)https://medium.com/@james_aka_yale/the-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223 -->
<html lang="en" class="gr__medium_com" data-rh="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./movie_files/branch-latest.min.js.download"></script><script type="text/javascript">
    (function() {
      var container = document.querySelector('#_tcx-cqg95vu652t');
      if (!container) {
        return;
      }

      var XHR = XMLHttpRequest.prototype;
      var send = XHR.send;
      var open = XHR.open;
      XHR.open = function(method, url) {
        this.url = url;
        return open.apply(this, arguments);
      };
      XHR.send = function() {
        this.addEventListener('load', function() {
          try {
            const response = this.response;
            if (response && response.length) {
              const firstChar = response[0];
              if (firstChar === '[' || firstChar === '{') {
                const wrapper = document.createElement('div');
                wrapper.setAttribute('data-tcx-url', this.url);
                wrapper.innerText = response;
                container.appendChild(wrapper);
              }
            }
          } catch (err) {
            // No-op.
          }
        });
        return send.apply(this, arguments);
      };
    })();
  </script><script async="" src="./movie_files/analytics.js.download"></script><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><title>The 4 Recommendation Engines That Can Predict Your Movie Tastes</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-04-28T09:07:53.719Z"><meta data-rh="true" name="title" content="The 4 Recommendation Engines That Can Predict Your Movie Tastes"><meta data-rh="true" property="og:title" content="The 4 Recommendation Engines That Can Predict Your Movie Tastes"><meta data-rh="true" property="twitter:title" content="The 4 Recommendation Engines That Can Predict Your Movie Tastes"><meta data-rh="true" name="twitter:site" content="@Medium"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/bbec857b8223"><meta data-rh="true" property="al:android:url" content="medium://p/bbec857b8223"><meta data-rh="true" property="al:ios:url" content="medium://p/bbec857b8223"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="Have you ever had to answer this question at least once when you came home from work? As for me — yes, and more than once. From Netflix to Hulu, the need to build robust movie recommendation systems…"><meta data-rh="true" property="og:description" content="“What movie should I watch this evening?”"><meta data-rh="true" property="twitter:description" content="“What movie should I watch this evening?”"><meta data-rh="true" property="og:url" content="https://medium.com/@james_aka_yale/the-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223"><meta data-rh="true" property="al:web:url" content="https://medium.com/@james_aka_yale/the-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223"><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1200/0*ox2NxC7NrvEs31a2."><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1200/0*ox2NxC7NrvEs31a2."><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="article:author" content="https://medium.com/@james_aka_yale"><meta data-rh="true" name="twitter:creator" content="@james_aka_yale"><meta data-rh="true" name="author" content="James Le"><meta data-rh="true" name="robots" content="index,follow"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" value="Reading time"><meta data-rh="true" name="twitter:data1" value="18 min read"><meta data-rh="true" name="parsely-post-id" content="bbec857b8223"><link data-rh="true" rel="publisher" href="https://plus.google.com/103654360130207659246"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://medium.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"><link data-rh="true" rel="icon" href="https://cdn-static-1.medium.com/_/fp/icons/favicon-rebrand-medium.3Y6xpZ-0FSdWDnPM3hSBIA.ico"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./movie_files/m2.css"><link data-rh="true" rel="author" href="https://medium.com/@james_aka_yale"><link data-rh="true" rel="canonical" href="https://medium.com/@james_aka_yale/the-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/bbec857b8223"><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="./movie_files/16180790160.js.download" as="script"><style type="text/css" data-fela-rehydration="450" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-webkit-keyframes k3{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@-moz-keyframes k3{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@keyframes k3{0%{transform:translateY(100%)}90%{transform:translateY(-5%)}100%{transform:translateY(0%)}}@-webkit-keyframes k4{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@-moz-keyframes k4{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@keyframes k4{0%{transform:translateY(0%);opacity:1}10%{transform:translateY(-5%);opacity:1}100%{transform:translateY(100%);opacity:0}}@-webkit-keyframes k5{25%{opacity:1.0}50%{opacity:0.2}75%{opacity:1.0}100%{transform:translateY(calc(-100% + 100px))}}@-moz-keyframes k5{25%{opacity:1.0}50%{opacity:0.2}75%{opacity:1.0}100%{transform:translateY(calc(-100% + 100px))}}@keyframes k5{25%{opacity:1.0}50%{opacity:0.2}75%{opacity:1.0}100%{transform:translateY(calc(-100% + 100px))}}@-webkit-keyframes k6{0%{opacity:0}100%{opacity:1}}@-moz-keyframes k6{0%{opacity:0}100%{opacity:1}}@keyframes k6{0%{opacity:0}100%{opacity:1}}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{fill:rgba(0, 0, 0, 0.84)}.r{display:block}.s{position:fixed}.t{top:0}.u{left:0}.v{right:0}.w{z-index:500}.x{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ai{max-width:1192px}.aj{min-width:0}.ak{width:100%}.al{height:65px}.ao{flex:1 0 auto}.ap{display:none}.ar{flex:0 0 auto}.as{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.at{font-style:normal}.au{line-height:20px}.av{font-size:15.8px}.aw{letter-spacing:0px}.ax{color:rgba(0, 0, 0, 0.54)}.ay{fill:rgba(0, 0, 0, 0.54)}.az{justify-content:flex-end}.ba{margin-top:16px}.bb{margin-bottom:16px}.bc{display:inherit}.bd{max-width:210px}.be{text-overflow:ellipsis}.bf{overflow:hidden}.bg{white-space:nowrap}.bh{display:inline-block}.bi{border:none}.bj{outline:none}.bk{font:inherit}.bl{font-size:16px}.bm{opacity:0}.bn{position:relative}.bo{width:0px}.bp{transition:width 140ms ease-in}.bq{color:inherit}.br{fill:inherit}.bs{font-size:inherit}.bt{border:inherit}.bu{font-family:inherit}.bv{letter-spacing:inherit}.bw{font-weight:inherit}.bx{padding:0}.by{margin:0}.bz:hover{cursor:pointer}.ca:hover{color:rgba(0, 0, 0, 0.9)}.cb:hover{fill:rgba(0, 0, 0, 0.9)}.cc:focus{outline:none}.cd:disabled{cursor:default}.ce:disabled{color:rgba(0, 0, 0, 0.54)}.cf:disabled{fill:rgba(0, 0, 0, 0.54)}.cg{margin-left:16px}.ch{margin-right:10px}.cl{margin-right:16px}.cm{visibility:hidden}.cn{padding:4px 12px}.co{color:rgba(0, 0, 0, 0.84)}.cp{background:0}.cq{border-color:rgba(0, 0, 0, 0.54)}.cr:hover{color:rgba(0, 0, 0, 0.97)}.cs:hover{fill:rgba(0, 0, 0, 0.97)}.ct:hover{border-color:rgba(0, 0, 0, 0.84)}.cu:disabled{fill:rgba(0, 0, 0, 0.76)}.cv:disabled{border-color:rgba(0, 0, 0, 0.2)}.cw:disabled{cursor:inherit}.cx:disabled:hover{color:rgba(0, 0, 0, 0.54)}.cy:disabled:hover{fill:rgba(0, 0, 0, 0.76)}.cz:disabled:hover{border-color:rgba(0, 0, 0, 0.2)}.da{border-radius:4px}.db{border-width:1px}.dc{border-style:solid}.dd{box-sizing:border-box}.de{text-decoration:none}.df{padding-bottom:10px}.dg{padding-top:10px}.dh{border-radius:50%}.di{height:32px}.dj{width:32px}.dk{margin-bottom:0px}.dm{padding-left:24px}.dn{padding-right:24px}.do{margin-left:auto}.dp{margin-right:auto}.dq{max-width:728px}.dr{flex-direction:column}.ds{position:absolute}.dt{top:calc(100vh + 100px)}.du{bottom:calc(100vh + 100px)}.dv{width:10px}.dw{pointer-events:none}.dx{word-break:break-word}.dy{word-wrap:break-word}.dz:after{display:block}.ea:after{content:""}.eb:after{clear:both}.ec{max-width:680px}.ed{line-height:1.23}.ee{letter-spacing:0}.ef{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.eg{font-size:40px}.em{margin-bottom:-0.27em}.en{line-height:48px}.eo{margin-top:32px}.ep{width:48px}.eq{height:48px}.er{fill:rgba(3, 168, 124, 1)}.es{flex-direction:row}.et{width:calc(100% + 25px)}.eu{height:calc(100% + 25px)}.ev{top:50%}.ew{left:50%}.ex{transform:translateX(-50%) translateY(-50%)}.ey{margin-left:12px}.ez{margin-bottom:2px}.fb{font-weight:300}.fc{max-height:20px}.fd{display:-webkit-box}.fe{-webkit-line-clamp:1}.ff{-webkit-box-orient:vertical}.fg:hover{text-decoration:underline}.fh{margin-left:8px}.fi{padding:0px 8px}.fj{color:rgba(255, 255, 255, 1)}.fk{fill:rgba(255, 255, 255, 1)}.fl{background:rgba(3, 168, 124, 1)}.fm{border-color:rgba(3, 168, 124, 1)}.fn:hover{background:rgba(2, 158, 116, 1)}.fo:hover{border-color:rgba(2, 158, 116, 1)}.fp:disabled{opacity:0.3}.fq:disabled:hover{background:rgba(3, 168, 124, 1)}.fr:disabled:hover{border-color:rgba(3, 168, 124, 1)}.fs{line-height:18px}.ft{font-size:15px}.fu{clear:both}.ga{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.gb{cursor:zoom-in}.gc{z-index:auto}.gd{transition:opacity 100ms 400ms}.ge{height:100%}.gf{will-change:transform}.gg{transform:translateZ(0)}.gh{margin:auto}.gi{background-color:rgba(0, 0, 0, 0.05)}.gj{padding-bottom:66.66666666666667%}.gk{filter:blur(20px)}.gl{transform:scale(1.1)}.gm{visibility:visible}.gn{background:rgba(255, 255, 255, 1)}.go{line-height:1.4}.gp{margin-top:10px}.gq{text-align:center}.gt{background-repeat:repeat-x}.gu{background-image:linear-gradient(to right,rgba(0, 0, 0, 0.84) 100%,rgba(0, 0, 0, 0.84) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(0, 0, 0, 0.84)" /></svg>')}.gv{background-size:1px 1px}.gw{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.gx{line-height:1.58}.gy{letter-spacing:-0.004em}.gz{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.hk{margin-bottom:-0.46em}.hl{font-style:italic}.hm{list-style-type:disc}.hn{margin-left:30px}.ho{padding-left:0px}.hp{font-weight:700}.id{max-width:1600px}.ie{padding-bottom:5px}.if{padding-top:5px}.ig{padding-bottom:62.375%}.ih{line-height:1.12}.ii{letter-spacing:-0.022em}.ij{font-weight:600}.iu{margin-bottom:-0.28em}.ja{max-width:941px}.jb{padding-bottom:50.47821466524973%}.jc{max-width:364px}.jd{border-width:2px}.je{border-color:rgba(255, 255, 255, 1)}.jf{float:left}.jg{margin-left:-150px}.jh{margin-right:30px}.ji{width:75%}.jn{padding-bottom:74.45054945054945%}.jo{max-width:956px}.jp{padding-bottom:41.52719665271967%}.jq{list-style-type:decimal}.jr{line-height:1.18}.kc{margin-bottom:-0.31em}.kd{max-width:702px}.ke{padding-bottom:40.883190883190885%}.kf{max-width:720px}.kg{padding-bottom:75%}.kh{padding:20px}.ki{background:rgba(0, 0, 0, 0.05)}.kj{overflow-x:auto}.kk{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.kl{margin-top:-0.09em}.km{margin-bottom:-0.09em}.kn{white-space:pre-wrap}.ko{max-width:960px}.kp{padding-bottom:72.91666666666667%}.kq{max-width:972px}.kr{padding-bottom:72.01646090534979%}.ks{max-width:618px}.kt{padding-bottom:113.59223300970874%}.ku{padding-bottom:56.25%}.la{max-width:975px}.lb{padding-bottom:61.230769230769226%}.lc{max-width:638px}.ld{padding-bottom:75.07836990595611%}.le{max-width:2543px}.lf{padding-bottom:55.878883208808496%}.lg{max-width:1344px}.lh{padding-bottom:90.92261904761905%}.li{max-width:651px}.lj{padding-bottom:39.1705069124424%}.lk{max-width:1246px}.ll{padding-bottom:98.23434991974318%}.lm{will-change:opacity}.ln{top:calc(65px + 54px + 40px)}.lq{width:131px}.lr{padding-top:28px}.ls{margin-bottom:19px}.lt{margin-left:-5px}.lu{margin-right:5px}.lv{outline:0}.lw{border:0}.lx{user-select:none}.ly{cursor:pointer}.lz> svg{pointer-events:none}.ma:active{border-style:none}.mb{-webkit-user-select:none}.mc{fill:rgba(0, 0, 0, 0.76)}.md:focus{fill:rgba(0, 0, 0, 0.54)}.me:hover{fill:rgba(0, 0, 0, 0.54)}.mf{margin-top:5px}.mg button{text-align:left}.mh{width:188px}.mi{transform:translateX(406px)}.mj{top:calc(65px + 54px + 14px)}.ml{margin-top:40px}.mm{flex-wrap:wrap}.mn{margin-top:25px}.mo{list-style-type:none}.mp{margin-right:8px}.mq{margin-bottom:8px}.mr{border-radius:3px}.ms{padding:5px 10px}.mt{line-height:22px}.mu{margin-top:15px}.mv{justify-content:space-between}.mw{border:1px solid rgba(0, 0, 0, 0.1)}.mx{height:60px}.my{width:60px}.nl:hover{border-color:rgba(0, 0, 0, 0.54)}.nm:active{border-style:solid}.nn{z-index:2}.np{padding-right:8px}.nq{padding-top:32px}.nr{border-top:1px solid rgba(0, 0, 0, 0.1)}.ns{margin-bottom:25px}.nt{margin-bottom:32px}.nu{min-height:80px}.nz{width:80px}.oa{height:80px}.ob{padding-left:102px}.od{text-transform:uppercase}.oe{letter-spacing:0.05em}.of{margin-bottom:6px}.og{font-size:28px}.oh{line-height:36px}.oi{max-width:555px}.oj{max-width:450px}.ok{font-size:18px}.ol{line-height:24px}.on{padding-top:25px}.oo{color:rgba(0, 0, 0, 0.76)}.op{opacity:1}.oq{color:rgba(2, 158, 116, 1)}.or{border:1px solid rgba(3, 168, 124, 1)}.os{margin-top:64px}.ot{background-color:rgba(0, 0, 0, 0.02)}.ou{padding:60px 0}.ov{background-color:rgba(0, 0, 0, 0.9)}.pm{padding-bottom:48px}.pn{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.po{margin:0 -12px}.pp{margin:0 12px}.pq{flex:1 1 0}.pr{padding-bottom:12px}.ps:hover{color:rgba(255, 255, 255, 0.99)}.pt:hover{fill:rgba(255, 255, 255, 0.99)}.pu:disabled{color:rgba(255, 255, 255, 0.7)}.pv:disabled{fill:rgba(255, 255, 255, 0.7)}.pw{color:rgba(255, 255, 255, 0.98)}.px{fill:rgba(255, 255, 255, 0.98)}.py{text-align:inherit}.pz{font-size:21.6px}.qa{letter-spacing:-0.32px}.qb{color:rgba(255, 255, 255, 0.7)}.qc{fill:rgba(255, 255, 255, 0.7)}.qd{text-decoration:underline}.qe{padding-bottom:8px}.qf{padding-top:8px}.qg{width:200px}.qi{margin:15px 0}.qj{-webkit-user-select:none}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ah{margin:0 64px}.el{margin-top:0.78em}.fz{margin-top:56px}.hi{font-size:21px}.hj{margin-top:2em}.hu{margin-top:1.05em}.ic{max-width:1192px}.is{font-size:34px}.it{margin-top:1.95em}.iz{margin-top:0.86em}.ka{font-size:26px}.kb{margin-top:1.72em}.kz{margin-top:1.91em}.pj{padding-left:64px}.pk{padding-right:64px}.pl{max-width:1320px}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.gr{margin-left:auto}.gs{text-align:center}.jj{float:none}.jk{margin-left:0}.jl{margin-right:0}.jm{width:100%}.pg{padding-left:64px}.ph{padding-right:64px}.pi{max-width:1080px}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.ck{display:flex}.pd{padding-left:48px}.pe{padding-right:48px}.pf{max-width:904px}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.am{height:56px}.an{display:flex}.aq{display:block}.ci{margin-left:10px}.cj{margin-right:10px}.dl{margin-bottom:0px}.nv{margin-bottom:24px}.nw{align-items:center}.nx{width:102px}.ny{position:relative}.oc{padding-left:0}.om{margin-top:24px}.ow{padding:32px 0}.pa{padding-left:24px}.pb{padding-right:24px}.pc{max-width:728px}.qh{width:140px}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ac{margin:0 24px}.eh{margin-top:0.39em}.fa{margin-bottom:0px}.fv{margin-top:40px}.ha{font-size:18px}.hb{margin-top:1.56em}.hq{margin-top:1.34em}.hv{margin:0}.hw{max-width:100%}.ik{font-size:30px}.il{margin-top:1.2em}.iv{margin-top:0.67em}.js{font-size:24px}.jt{margin-top:1.23em}.kv{margin-top:1.41em}.ox{padding-left:24px}.oy{padding-right:24px}.oz{max-width:552px}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ag{margin:0 64px}.ek{margin-top:0.78em}.fy{margin-top:56px}.hg{font-size:21px}.hh{margin-top:2em}.ht{margin-top:1.05em}.ib{max-width:1192px}.iq{font-size:34px}.ir{margin-top:1.95em}.iy{margin-top:0.86em}.jy{font-size:26px}.jz{margin-top:1.72em}.ky{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.af{margin:0 48px}.ej{margin-top:0.78em}.fx{margin-top:56px}.he{font-size:21px}.hf{margin-top:2em}.hs{margin-top:1.05em}.hz{margin:0}.ia{max-width:100%}.io{font-size:34px}.ip{margin-top:1.95em}.ix{margin-top:0.86em}.jw{font-size:26px}.jx{margin-top:1.72em}.kx{margin-top:1.91em}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ae{margin:0 24px}.ei{margin-top:0.39em}.fw{margin-top:40px}.hc{font-size:18px}.hd{margin-top:1.56em}.hr{margin-top:1.34em}.hx{margin:0}.hy{max-width:100%}.im{font-size:30px}.in{margin-top:1.2em}.iw{margin-top:0.67em}.ju{font-size:24px}.jv{margin-top:1.23em}.kw{margin-top:1.41em}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="print">.ab{display:none}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.y{transition:transform 300ms ease}.z{will-change:transform}.lo{transition:opacity 200ms}.mz{transition:border-color 150ms ease}.na::before{background:
      radial-gradient(circle, rgba(0, 0, 0, 0.84) 60%, transparent 70%)
    }.nb::before{border-radius:50%}.nc::before{content:""}.nd::before{display:block}.ne::before{z-index:0}.nf::before{left:0}.ng::before{height:100%}.nh::before{position:absolute}.ni::before{top:0}.nj::before{width:100%}.nk:hover::before{animation:k2 2000ms infinite cubic-bezier(.1,.12,.25,1)}.no{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (max-width: 1198px)">.lp{display:none}</style><style type="text/css" data-fela-rehydration="450" data-fela-type="RULE" media="all and (max-width: 1230px)">.mk{display:none}</style><script charset="utf-8" src="./movie_files/vendors_tracing.28033849.chunk.js.download"></script><script charset="utf-8" src="./movie_files/tracing.a9025c45.chunk.js.download"></script><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F0*ox2NxC7NrvEs31a2."],"url":"https:\u002F\u002Fmedium.com\u002F@james_aka_yale\u002Fthe-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223","dateCreated":"2018-04-22T11:48:56.808Z","datePublished":"2018-04-22T11:48:56.808Z","dateModified":"2018-06-14T12:39:23.892Z","headline":"The 4 Recommendation Engines That Can Predict Your Movie Tastes","name":"The 4 Recommendation Engines That Can Predict Your Movie Tastes","description":"Have you ever had to answer this question at least once when you came home from work? As for me — yes, and more than once. From Netflix to Hulu, the need to build robust movie recommendation systems…","identifier":"bbec857b8223","keywords":["Lite:true","Tag:Recommendation System","Tag:Movies","Tag:Machine Learning","Tag:Personalization","Tag:Predictions","Topic:Data Science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_UGC","LayerCake:4"],"author":{"@type":"Person","name":"James Le","url":"https:\u002F\u002Fmedium.com\u002F@james_aka_yale"},"creator":["James Le"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F354\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@james_aka_yale\u002Fthe-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223","isAccessibleForFree":"False","hasPart":{"@type":"WebPageElement","isAccessibleForFree":"False","cssSelector":".meteredContent"}}</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script></head><body data-gr-c-s-loaded="true"><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="s qk ak ql qm qn qo"><div class="gm" id="li-meter-banner-background-color"><div class="qp qq qr ak r bn gn qs qt qu"><div class="ro qr rp n dr p rq"><div class="n"><div class="gm" id="li-meter-banner-meter-count-slot-machine"><div class="r rr"><div class="rs bf bn rt ru rv rw ea rx"><div class="ry rz er sa"><div class="sb at sc sd n p rs dr gq">3</div><div class="sb at sc sd n p rs dr gq">2</div></div></div></div></div><div class="se sf n dr sg rq sh si"><div class="gm" id="li-meter-banner-header"><div class="sj r sk"><h2 class="sd sc ha sl hc sm sn so sp sq sr ss co">Smart stories. New ideas. No ads. $5/month.</h2></div></div><div class="gm" id="li-meter-banner-desktop-expandable-section"><div class="r g"><div class="qv bf qw qx qy qz ra rb rc rd re rf rg rh"><div class="gm" id="li-meter-banner-desktop-expanded-copy"><h4 class="as fb ok ol ax">Members get unlimited access to the best stories on Medium — but you can read three for free this month. Upgrade for $5/month.</h4></div><div><div class="st su bh gq g"><div class="gm" id="li-meter-banner-desktop-upsell-button"><a href="https://medium.com/membership?source=upgrade_membership---post_counter------------------------" class="sv fj fk sw sx da as b at au av aw sy db dc dd bh de bz cc" rel="noopener">Upgrade</a></div></div><div class="sz ap gq ta aq"><div class="gm" id="li-meter-banner-mobile-upsell-button"><a href="https://medium.com/membership?source=upgrade_membership---post_counter------------------------" class="cn fj fk sw sx da as b at au av aw sy db dc dd bh de bz cc" rel="noopener">Upgrade</a></div></div></div></div></div></div></div><div class="tb n dr p sh si"><div class="tc n p"><div class="gm" id="li-meter-banner-details-button"><div class="gm ay ri rj rk rl rm rn"><h4 class="as fb bl au ax"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><div class="td te tf f">Details</div><div class="te sh aq"><svg width="19" height="19"><path d="M3.9 6.77l5.2 5.76.43.47.43-.47 5.15-5.7-.85-.77-4.73 5.25L4.75 6z" fill-rule="evenodd"></path></svg></div></button></h4></div></div><div class="gm" id="li-meter-banner-close-button"><div class="tg r sh g"><div class="by r bn v"><span class="as b at au av aw r ax ay"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="19" height="19" viewBox="0 0 19 19"><path d="M13.8 4.6L9.5 8.89 5.21 4.6l-.61.61 4.29 4.3-4.29 4.28.61.62 4.3-4.3 4.28 4.3.62-.62-4.3-4.29 4.3-4.29" fill-rule="evenodd"></path></svg></button></span></div></div></div></div></div></div><div class="gm" id="li-meter-banner-mobile-expandable-section"><div class="ap th aq ti"><div class="qv bf qw qx qy qz ra rb rc rd re rf rg rh"><div class="gm" id="li-meter-banner-mobile-expanded-copy"><h4 class="as fb ok ol ax">Welcome to your free member preview for this month. Upgrade for unlimited access.</h4></div><div><div class="st su bh gq g"><div class="gm" id="li-meter-banner-desktop-upsell-button"><a href="https://medium.com/membership?source=upgrade_membership---post_counter------------------------" class="sv fj fk sw sx da as b at au av aw sy db dc dd bh de bz cc" rel="noopener">Upgrade</a></div></div><div class="sz ap gq ta aq"><div class="gm" id="li-meter-banner-mobile-upsell-button"><a href="https://medium.com/membership?source=upgrade_membership---post_counter------------------------" class="cn fj fk sw sx da as b at au av aw sy db dc dd bh de bz cc" rel="noopener">Upgrade</a></div></div></div></div></div></div></div></div></div></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="r s t u v c w x y z ab" style=""><div class="branch-journeys-top"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="al n o am an"><div class="r ao w"><div class="n o"><a href="https://medium.com/?source=post_page-----bbec857b8223----------------------" aria-label="Homepage" rel="noopener"><div class="ap g"><svg height="22" width="112" viewBox="0 0 111.5 22" class="q"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></div><div class="r aq"><svg width="35" height="35" viewBox="5 5 35 35" class="q"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></div></a></div></div><div class="r ar w"><span class="as b at au av aw r ax ay"><div class="n o az"><div class="n f"><div class="bh"><div class="n"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" viewBox="0 0 25 25" class="cg ch r ci cj"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></button><input class="bi bj bk bl au bm bn bo bp" placeholder="Search Medium" value=""></div></div></div><div class="ap ck"><a href="https://medium.com/search?source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25" class="cg cl r ci cj"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></a></div><div class="cl n cj"><div class="bh"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf r"><svg width="25" height="25" viewBox="-293 409 25 25" class="qi r"><path d="M-273.33 423.67l-1.67-1.52v-3.65a5.5 5.5 0 0 0-6.04-5.47 5.66 5.66 0 0 0-4.96 5.71v3.41l-1.68 1.55a1 1 0 0 0-.32.74V427a1 1 0 0 0 1 1h3.49a3.08 3.08 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59a1 1 0 0 0-.33-.74zm-7.17 5.63c-.84 0-1.55-.55-1.81-1.3h3.62a1.92 1.92 0 0 1-1.81 1.3zm6.35-2.45h-12.7v-2.35l1.63-1.5c.24-.22.37-.53.37-.85v-3.41a4.51 4.51 0 0 1 3.92-4.57 4.35 4.35 0 0 1 4.78 4.33v3.65c0 .32.14.63.38.85l1.62 1.48v2.37z"></path></svg></button></div></div><div class="gm" id="li-post-page-navbar-upsell-button"><div class="cl r g"><div><a href="https://medium.com/membership?source=upgrade_membership---nav_full------------------------" class="cn co q cp cq cr cs ct bz ce cu cv cw cx cy cz da as b at au av aw db dc dd bh de cc" rel="noopener">Upgrade</a></div></div></div><div class="n"><div class="df dg n o"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><img alt="Sai Charan Arishanapally" class="r dh di dj" src="./movie_files/2_5hGxbnmvqtZYznx3jDcYMA.jpeg" width="32" height="32"></button></div></div></div></span></div></div></div></div></div></nav><div class="dk al r dl am"></div><article class="meteredContent"><section class="dm dn do dp ak dq dd n dr"></section><span class="r"></span><div><div class="ds u dt du dv dw"></div><div class="do dp dq bn"><div class="r h g f e"><aside class="tk ds t" style="width: 206.918px;"><div class="wo wa ds wp bg ak"><h4 class="as fb ft au ax"><span class="bh wa bg bf be">Top highlight</span></h4></div></aside></div></div><section class="dx dy dz ea eb"><div class="n p"><div class="ac ae af ag ah ec aj ak"><div><div id="5014" class="ed ee co at ef b eg eh ei ej ek el em"><h1 class="ef b eg en co">The 4 Recommendation Engines That Can Predict Your Movie Tastes</h1></div><div class="eo"><div class="o n"><div><a rel="noopener" href="https://medium.com/@james_aka_yale?source=post_page-----bbec857b8223----------------------"><div class="bn ep eq"><div class="er n es o p ds et eu ev ew ex dw"><svg width="57" height="57" viewBox="0 0 57 57"><path fill-rule="evenodd" clip-rule="evenodd" d="M28.5 1.2A27.45 27.45 0 0 0 4.06 15.82L3 15.27A28.65 28.65 0 0 1 28.5 0C39.64 0 49.29 6.2 54 15.27l-1.06.55A27.45 27.45 0 0 0 28.5 1.2zM4.06 41.18A27.45 27.45 0 0 0 28.5 55.8a27.45 27.45 0 0 0 24.44-14.62l1.06.55A28.65 28.65 0 0 1 28.5 57 28.65 28.65 0 0 1 3 41.73l1.06-.55z"></path></svg></div><img alt="James Le" class="r dh eq ep" src="./movie_files/1_kbXSc2-EEtk9ekKq36woIQ.jpeg" width="48" height="48"></div></a></div><div class="ey ak r"><div class="n"><div style="flex:1"><span class="as b at au av aw r co q"><div class="ez n o fa"><span class="as fb bl au bf fc be fd fe ff co"><a class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener" href="https://medium.com/@james_aka_yale?source=post_page-----bbec857b8223----------------------">James Le</a></span><div class="fh r ar h"><button class="fi fj fk fl fm fn fo bz cw fp fq fr da as b at fs ft aw db dc dd bh de cc">Following</button></div></div></span></div></div><span class="as b at au av aw r ax ay"><span class="as fb bl au bf fc be fd fe ff ax"><div><a class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener" href="https://medium.com/@james_aka_yale/the-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223?source=post_page-----bbec857b8223----------------------">Apr 22, 2018</a> <!-- -->·<!-- --> <!-- -->18<!-- --> min read<span style="padding-left:4px"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top:-2px"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div></div></div></div><div class="fu ak"><figure class="fv fw fx fy fz fu ak paragraph-image"><div class="ga gb bn gc ak"><div class="gh r bn gi"><div class="gj r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/0_ox2NxC7NrvEs31a2_" width="6240" height="4160" role="presentation"></div><img class="op tj ds t u ge ak gn" width="6240" height="4160" role="presentation" src="./movie_files/0_ox2NxC7NrvEs31a2_(1)"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/12480/0*ox2NxC7NrvEs31a2." width="6240" height="4160" role="presentation"/></noscript></div></div></div><figcaption class="ax bl go gp gq dq do dp gr gs as fb" data-selectable-paragraph="">Photo by <a href="https://unsplash.com/@jeshoots?utm_source=medium&amp;utm_medium=referral" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">JESHOOTS.COM</a> on <a href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">Unsplash</a></figcaption></figure></div><div class="n p"><div class="ac ae af ag ah ec aj ak"><p id="a208" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">“<em class="hl">What movie should I watch this evening?</em>”</p><p id="5f06" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Have you ever had to answer this question at least once when you came home from work? As for me — yes, and more than once. From Netflix to Hulu, the need to build robust movie recommendation systems is extremely important given the huge demand for personalized content of modern consumers.</p><p id="12ae" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">An example of recommendation system is such as this:</p><ul class=""><li id="fd5a" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk hm hn ho" data-selectable-paragraph="">User A watches <strong class="gz hp">Game of Thrones</strong> and <strong class="gz hp">Breaking Bad</strong>.</li><li id="13b1" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">User B does search on <strong class="gz hp">Game of Thrones</strong>, then the system suggests <strong class="gz hp">Breaking Bad</strong> from data collected about user A.</li></ul><p id="b071" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Recommendation systems are used not only for movies, but on multiple other products and services like Amazon (Books, Items), Pandora/Spotify (Music), Google (News, Search), YouTube (Videos) etc.</p></div></div><div class="fu"><div class="n p"><div class="hv hw hx hy hz ia ag ib ah ic aj ak"><figure class="fv fw fx fy fz fu ie if paragraph-image"><div class="ga ws wt ds wu wv ww"><div class="do dp id"><div class="gh r bn gi"><div class="ig r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_dMR3xmufnmKiw4crlisQUA.png" width="1600" height="998" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="1600" height="998" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/3200/1*dMR3xmufnmKiw4crlisQUA.png" width="1600" height="998" role="presentation"/></noscript></div></div></div></div></figure></div></div></div><div class="n p"><div class="ac ae af ag ah ec aj ak"><p id="1bff" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">In this post, I will show you how to implement the 4 different movie recommendation approaches and evaluate them to see which one has the best performance.</p><h1 id="1f24" class="ih ii co at as ij ik il im in io ip iq ir is it iu" data-selectable-paragraph=""><strong class="bw">The MovieLens Dataset</strong></h1><p id="852c" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">The dataset that I’m working with is <a href="https://grouplens.org/datasets/movielens/" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">MovieLens</a>, one of the most common datasets that is available on the internet for building a Recommender System. The version of the dataset that I’m working with (<a href="https://grouplens.org/datasets/movielens/1m/" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">1M</a>) contains 1,000,209 anonymous ratings of approximately 3,900 movies made by 6,040 MovieLens users who joined MovieLens in 2000.</p><p id="cf11" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">After processing the data and doing some exploratory analysis, here are the most interesting features of this dataset:</p><p id="ca51" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Here’s a word-cloud visualization of the <strong class="gz hp">movie titles</strong>:</p><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp ja"><div class="gh r bn gi"><div class="jb r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/1_qMrcVoRVNmxgHODwyYGE_w.png" width="941" height="475" role="presentation"></div><img class="op tj ds t u ge ak gn" width="941" height="475" role="presentation" src="./movie_files/1_qMrcVoRVNmxgHODwyYGE_w(1).png"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1882/1*qMrcVoRVNmxgHODwyYGE_w.png" width="941" height="475" role="presentation"/></noscript></div></div></div></div></figure><p id="704d" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Beautiful, isn’t it? I can recognize that there are a lot of movie franchises in this dataset, as evidenced by words like <em class="hl">II</em> and <em class="hl">III</em>… In addition to that, <em class="hl">Day</em>, <em class="hl">Love</em>, <em class="hl">Life</em>, <em class="hl">Time</em>, <em class="hl">Night</em>, <em class="hl">Man</em>, <em class="hl">Dead</em>, <em class="hl">American</em> are among the most commonly occuring words.</p><p id="1e96" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Here’s a distribution of the <strong class="gz hp">user ratings</strong>:</p><figure class="fv fw fx fy fz fu gn jd dc je jf jg jh ji bx df jj jk jl jm bb paragraph-image"><div class="do dp jc"><div class="gh r bn gi"><div class="jn r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/1_P_NyzkYXMGipY7Gm9oGl2w.png" width="364" height="271" role="presentation"></div><img class="op tj ds t u ge ak gn" width="364" height="271" role="presentation" src="./movie_files/1_P_NyzkYXMGipY7Gm9oGl2w(1).png"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/728/1*P_NyzkYXMGipY7Gm9oGl2w.png" width="364" height="271" role="presentation"/></noscript></div></div></div></figure><p id="031a" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">It appears that users are quite generous in their ratings. The mean rating is 3.58 on a scale of 5. Half the movies have a rating of 4 and 5. I personally think that a 5-level rating skill wasn’t a good indicator as people could have different rating styles (i.e. person A could always use 4 for an average movie, whereas person B only gives 4 out for their favorites). Each user rated at least 20 movies, so I doubt the distribution could be caused just by chance variance in the quality of movies.</p><p id="2220" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Here’s another word-cloud of the <strong class="gz hp">movie genres:</strong></p><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp jo"><div class="gh r bn gi"><div class="jp r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/1_Q9zePC_ggd0GB6r67Uw1Bw.png" width="956" height="397" role="presentation"></div><img class="op tj ds t u ge ak gn" width="956" height="397" role="presentation" src="./movie_files/1_Q9zePC_ggd0GB6r67Uw1Bw(1).png"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1912/1*Q9zePC_ggd0GB6r67Uw1Bw.png" width="956" height="397" role="presentation"/></noscript></div></div></div></div></figure><p id="79b0" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">The top 5 genres are, in that respect order: Drama, Comedy, Action, Thriller, and Romance.</p><p id="a392" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Now let’s move on to explore the 4 recommendation systems that can be used. Here they are, in respective order of presentation:</p><ol class=""><li id="af70" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk jq hn ho" data-selectable-paragraph="">Content-Based Filtering</li><li id="61e4" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk jq hn ho" data-selectable-paragraph="">Memory-Based Collaborative Filtering</li><li id="cf08" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk jq hn ho" data-selectable-paragraph="">Model-Based Collaborative Filtering</li><li id="5754" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk jq hn ho" data-selectable-paragraph="">Deep Learning / Neural Network</li></ol><h1 id="3618" class="ih ii co at as ij ik il im in io ip iq ir is it iu" data-selectable-paragraph=""><strong class="bw">1 - Content-Based</strong></h1><p id="1c00" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">The Content-Based Recommender relies on the similarity of the items being recommended. The basic idea is that if you like an item, then you will also like a “similar” item. It generally works well when it’s easy to determine the context/properties of each item.</p><p id="fda8" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">A content based recommender works with data that the user provides, either explicitly movie ratings for the MovieLens dataset. Based on that data, a user profile is generated, which is then used to make suggestions to the user. As the user provides more inputs or takes actions on the recommendations, the engine becomes more and more accurate.</p><h2 id="0217" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Math</strong></h2><p id="19a4" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">The concepts of <strong class="gz hp">Term Frequency (TF)</strong> and <mark class="tl tm ly"><strong class="gz hp">Inverse Document Frequency</strong></mark><strong class="gz hp"> (IDF)</strong> are used in information retrieval systems and also content based filtering mechanisms (such as a content based recommender). They are used to determine the relative importance of a document / article / news item / movie etc.</p><p id="3d1c" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">TF is simply the frequency of a word in a document. IDF is the inverse of the document frequency among the whole corpus of documents. TF-IDF is used mainly because of two reasons: Suppose we search for “<strong class="gz hp">the results of latest European Socccer games</strong>” on Google. It is certain that “<strong class="gz hp">the</strong>” will occur more frequently than “<strong class="gz hp">soccer games</strong>” but the relative importance of <strong class="gz hp">soccer games</strong> is higher than the search query point of view. In such cases, TF-IDF weighting negates the effect of high frequency words in determining the importance of an item (document).</p><p id="706d" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Below is the equation to calculate the TF-IDF score:</p><figure class="fv fw fx fy fz fu gn jd dc je jf jg jh ji bx df jj jk jl jm bb paragraph-image"><div class="ga gb bn gc ak"><div class="do dp kd"><div class="gh r bn gi"><div class="ke r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/1_KZrjbKHcsWt-zzUj2oRk3w.jpeg" width="702" height="287" role="presentation"></div><img class="op tj ds t u ge ak gn" width="702" height="287" role="presentation" src="./movie_files/1_KZrjbKHcsWt-zzUj2oRk3w(1).jpeg"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1404/1*KZrjbKHcsWt-zzUj2oRk3w.jpeg" width="702" height="287" role="presentation"/></noscript></div></div></div></div></figure><p id="69b0" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">After calculating TF-IDF scores, how do we determine which items are closer to each other, rather closer to the user profile? This is accomplished using the <strong class="gz hp">Vector Space Model</strong> which computes the proximity based on the angle between the vectors. In this model, each item is stored as a vector of its attributes (which are also vectors) in an <strong class="gz hp">n-dimensional space</strong> and the angles between the vectors are calculated to <strong class="gz hp">determine the similarity between the vectors</strong>. Next, the user profile vectors are also created based on his actions on previous attributes of items and the similarity between an item and a user is also determined in a similar way.</p><figure class="fv fw fx fy fz fu gn jd dc je jf jg jh ji bx df jj jk jl jm bb paragraph-image"><div class="ga gb bn gc ak"><div class="do dp kf"><div class="gh r bn gi"><div class="kg r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/1_b06OA4v3x3yhQiFNNzbzow.png" width="720" height="540" role="presentation"></div><img class="op tj ds t u ge ak gn" width="720" height="540" role="presentation" src="./movie_files/1_b06OA4v3x3yhQiFNNzbzow(1).png"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1440/1*b06OA4v3x3yhQiFNNzbzow.png" width="720" height="540" role="presentation"/></noscript></div></div></div></div></figure><p id="3d42" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Sentence 2 is more likely to be using Term 2 than using Term 1. Vice-versa for Sentence 1. The method of calculating this relative measure is calculated by taking the cosine of the angle between the sentences and the terms. The ultimate reason behind using cosine is that the <strong class="gz hp">value of cosine will increase with decreasing value of the angle</strong> between which signifies more similarity. The vectors are length normalized after which they become vectors of length 1 and then the cosine calculation is simply the sum-product of vectors.</p><h2 id="76ec" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Code</strong></h2><p id="6950" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">With all that math in mind, I am going to build a Content-Based Recommendation Engine that computes similarity between movies based on movie genres. It will suggest movies that are most similar to a particular movie based on its genre.</p><p id="50b3" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">I do not have a quantitative metric to judge the machine’s performance so this will have to be done qualitatively. In order to do so, I’ll use <strong class="gz hp">TfidfVectorizer</strong> function from <strong class="gz hp">scikit-learn</strong>, which transforms text to feature vectors that can be used as input to estimator.</p><pre class="fv fw fx fy fz kh ki kj"><span id="ed3c" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><strong class="kk hp">from</strong> <strong class="kk hp">sklearn.feature_extraction.text</strong> <strong class="kk hp">import</strong> TfidfVectorizer<br>tf = TfidfVectorizer(analyzer='word',ngram_range=(1, 2),min_df=0, stop_words='english')<br>tfidf_matrix = tf.fit_transform(movies['genres'])</span></pre><p id="829a" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">I will be using the <a href="https://masongallo.github.io/machine/learning,/python/2016/07/29/cosine-similarity.html" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow"><strong class="gz hp">Cosine Similarity</strong></a> to calculate a numeric quantity that denotes the similarity between two movies. Since I have used the TF-IDF Vectorizer, calculating the Dot Product will directly give me the Cosine Similarity Score. Therefore, I will use sklearn’s <strong class="gz hp">linear_kernel</strong> instead of cosine_similarities since it is much faster.</p><pre class="fv fw fx fy fz kh ki kj"><span id="7503" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><strong class="kk hp">from</strong> <strong class="kk hp">sklearn.metrics.pairwise</strong> <strong class="kk hp">import</strong> linear_kernel<br>cosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)</span></pre><p id="7367" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">I now have a pairwise cosine similarity matrix for all the movies in the dataset. The next step is to write a function that returns the 20 most similar movies based on the cosine similarity score.</p><pre class="fv fw fx fy fz kh ki kj"><span id="4e92" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Build a 1-dimensional array with movie titles</em><br>titles = movies['title']<br>indices = pd.Series(movies.index, index=movies['title'])<br><br><em class="hl"># Function that get movie recommendations based on the cosine similarity score of movie genres</em><br><strong class="kk hp">def</strong> genre_recommendations(title):<br>    idx = indices[title]<br>    sim_scores = list(enumerate(cosine_sim[idx]))<br>    sim_scores = sorted(sim_scores, key=<strong class="kk hp">lambda</strong> x: x[1], reverse=<strong class="kk hp">True</strong>)<br>    sim_scores = sim_scores[1:21]<br>    movie_indices = [i[0] <strong class="kk hp">for</strong> i <strong class="kk hp">in</strong> sim_scores]<br>    <strong class="kk hp">return</strong> titles.iloc[movie_indices]</span></pre><h2 id="9b2e" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Recommendation</strong></h2><p id="5084" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">Let’s try and get the top recommendations for a few movies and see how good the recommendations are.</p><pre class="fv fw fx fy fz kh ki kj"><span id="e33b" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">genre_recommendations('Good Will Hunting (1997)').head(20)</span></pre><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp ko"><div class="gh r bn gi"><div class="kp r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/1_zRAvGlrgLCZwqTrmlv30Jw.png" width="960" height="700" role="presentation"></div><img class="op tj ds t u ge ak gn" width="960" height="700" role="presentation" src="./movie_files/1_zRAvGlrgLCZwqTrmlv30Jw(1).png"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1920/1*zRAvGlrgLCZwqTrmlv30Jw.png" width="960" height="700" role="presentation"/></noscript></div></div></div></div></figure><pre class="fv fw fx fy fz kh ki kj"><span id="ad2a" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">genre_recommendations('Toy Story (1995)').head(20)</span></pre><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp kq"><div class="gh r bn gi"><div class="kr r"><div class="bm gd ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl cm wr" src="./movie_files/1_E3kOkf1lNUg-mlVKtTRofA.png" width="972" height="700" role="presentation"></div><img class="op tj ds t u ge ak gn" width="972" height="700" role="presentation" src="./movie_files/1_E3kOkf1lNUg-mlVKtTRofA(1).png"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1944/1*E3kOkf1lNUg-mlVKtTRofA.png" width="972" height="700" role="presentation"/></noscript></div></div></div></div></figure><pre class="fv fw fx fy fz kh ki kj"><span id="3561" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">genre_recommendations('Saving Private Ryan (1998)').head(20)</span></pre><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="do dp ks"><div class="gh r bn gi"><div class="kt r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_yUxyA60SFJ3yRaikiM4GBw.png" width="618" height="702" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="618" height="702" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1236/1*yUxyA60SFJ3yRaikiM4GBw.png" width="618" height="702" role="presentation"/></noscript></div></div></div></figure><p id="2668" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">As you can see, I have quite a decent list of recommendation for <strong class="gz hp">Good Will Hunting</strong> (Drama), <strong class="gz hp">Toy Story</strong> (Animation, Children’s, Comedy), and <strong class="gz hp">Saving Private Ryan</strong> (Action, Thriller, War).</p><p id="db8a" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Overall, here are the pros of using content-based recommendation:</p><ul class=""><li id="d734" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk hm hn ho" data-selectable-paragraph="">No need for data on other users, thus no cold-start or sparsity problems.</li><li id="02b7" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">Can recommend to users with unique tastes.</li><li id="06b8" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">Can recommend new &amp; unpopular items.</li><li id="6ea5" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">Can provide explanations for recommended items by listing content-features that caused an item to be recommended (in this case, movie genres)</li></ul><p id="94e0" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">However, there are some cons of using this approach:</p><ul class=""><li id="5ef6" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk hm hn ho" data-selectable-paragraph="">Finding the appropriate features is hard.</li><li id="17bd" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">Does not recommend items outside a user’s content profile.</li><li id="c4b0" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">Unable to exploit quality judgments of other users.</li></ul><h1 id="f508" class="ih ii co at as ij ik il im in io ip iq ir is it iu" data-selectable-paragraph=""><strong class="bw">2 — Collaborative Filtering</strong></h1><p id="cac8" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">The Collaborative Filtering Recommender is entirely based on the past behavior and not on the context. More specifically, it is based on the similarity in preferences, tastes and choices of two users. It analyses how similar the tastes of one user is to another and makes recommendations on the basis of that.</p><p id="7b38" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">For instance, if user A likes movies 1, 2, 3 and user B likes movies 2,3,4, then they have similar interests and A should like movie 4 and B should like movie 1. This makes it one of the most commonly used algorithm as it is not dependent on any additional information.</p><p id="a68e" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">In general, collaborative filtering is the workhorse of recommender engines. The algorithm has a very interesting property of being able to do feature learning on its own, which means that it can start to learn for itself what features to use.</p><h2 id="4948" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Math</strong></h2><p id="cdac" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">There are 2 main types of memory-based collaborative filtering algorithms:</p><ol class=""><li id="caec" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk jq hn ho" data-selectable-paragraph=""><strong class="gz hp">User-User Collaborative Filtering</strong>: Here we find look alike users based on similarity and recommend movies which first user’s look-alike has chosen in past. This algorithm is very effective but takes a lot of time and resources. It requires to compute every user pair information which takes time. Therefore, for big base platforms, this algorithm is hard to implement without a very strong parallelizable system.</li><li id="fe5d" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk jq hn ho" data-selectable-paragraph=""><strong class="gz hp">Item-Item Collaborative Filtering</strong>: It is quite similar to previous algorithm, but instead of finding user’s look-alike, we try finding movie’s look-alike. Once we have movie’s look-alike matrix, we can easily recommend alike movies to user who have rated any movie from the dataset. This algorithm is far less resource consuming than user-user collaborative filtering. Hence, for a new user, the algorithm takes far lesser time than user-user collaborate as we don’t need all similarity scores between users. And with fixed number of movies, movie-movie look alike matrix is fixed over time.</li></ol><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp ko"><div class="gh r bn gi"><div class="ku r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_QvhetbRjCr1vryTch_2HZQ.jpeg" width="960" height="540" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="960" height="540" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1920/1*QvhetbRjCr1vryTch_2HZQ.jpeg" width="960" height="540" role="presentation"/></noscript></div></div></div></div></figure><p id="345f" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">In either scenario, we builds a similarity matrix. For user-user collaborative filtering, the <strong class="gz hp">user-similarity matrix</strong> will consist of some distance metrics that measure the similarity between any two pairs of users. Likewise, the <strong class="gz hp">item-similarity matrix</strong> will measure the similarity between any two pairs of items.</p><p id="1d53" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">There are 3 distance similarity metrics that are usually used in collaborative filtering:</p><ol class=""><li id="5175" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk jq hn ho" data-selectable-paragraph=""><strong class="gz hp">Jaccard Similarity</strong>: Similarity is based on the number of users which have rated item A and B divided by the number of users who have rated either A or B. It is typically used where we don’t have a numeric rating but just a boolean value like a product being bought or an add being clicked.</li><li id="ff2a" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk jq hn ho" data-selectable-paragraph=""><strong class="gz hp">Cosine Similarity</strong>: (as in the Content-Based system) Similarity is the cosine of the angle between the 2 vectors of the item vectors of A and B. Closer the vectors, smaller will be the angle and larger the cosine.</li><li id="e790" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk jq hn ho" data-selectable-paragraph=""><strong class="gz hp">Pearson Similarity</strong>: Similarity is the pearson coefficient between the two vectors. For the purpose of diversity, I will use <strong class="gz hp">Pearson Similarity</strong> in this implementation.</li></ol><h2 id="3e27" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Code</strong></h2><p id="d389" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">Due to the limited computing power in my laptop, I will build the recommender system using only a subset of the ratings. In particular, I will take a random sample of 20,000 ratings (2%) from the 1M ratings.</p><p id="91b0" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">I use the <strong class="gz hp">scikit-learn library</strong> to split the dataset into testing and training. <strong class="gz hp">Cross_validation.train_test_split</strong> shuffles and splits the data into two datasets according to the percentage of test examples, which in this case is 0.2.</p><pre class="fv fw fx fy fz kh ki kj"><span id="4e20" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><strong class="kk hp">from</strong> <strong class="kk hp">sklearn</strong> <strong class="kk hp">import</strong> cross_validation <strong class="kk hp">as</strong> cv<br>train_data, test_data = cv.train_test_split(small_data, test_size=0.2)</span></pre><p id="3b05" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Now I need to create a user-item matrix. Since I have splitted the data into testing and training, I need to create two matrices. The training matrix contains 80% of the ratings and the testing matrix contains 20% of the ratings.</p><pre class="fv fw fx fy fz kh ki kj"><span id="05c5" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Create two user-item matrices, one for training and another for testing</em><br>train_data_matrix = train_data.as_matrix(columns = ['user_id', 'movie_id', 'rating'])<br>test_data_matrix = test_data.as_matrix(columns = ['user_id', 'movie_id', 'rating'])</span></pre><p id="de98" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Now I use the <strong class="gz hp">pairwise_distances</strong> function from sklearn to calculate the <a href="https://stackoverflow.com/questions/1838806/euclidean-distance-vs-pearson-correlation-vs-cosine-similarity" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">Pearson Correlation Coefficient</a>. This method provides a safe way to take a distance matrix as input, while preserving compatibility with many other algorithms that take a vector array.</p><pre class="fv fw fx fy fz kh ki kj"><span id="804a" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><strong class="kk hp">from</strong> <strong class="kk hp">sklearn.metrics.pairwise</strong> <strong class="kk hp">import</strong> pairwise_distances<br><br><em class="hl"># User Similarity Matrix</em><br>user_correlation = 1 - pairwise_distances(train_data, metric='correlation')<br>user_correlation[np.isnan(user_correlation)] = 0</span><span id="aab7" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph=""><em class="hl"># Item Similarity Matrix</em><br>item_correlation = 1 - pairwise_distances(train_data_matrix.T, metric='correlation')<br>item_correlation[np.isnan(item_correlation)] = 0</span></pre><p id="f486" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">With the similarity matrix in hand, I can now predict the ratings that were not included with the data. Using these predictions, I can then compare them with the test data to attempt to validate the quality of our recommender model.</p><pre class="fv fw fx fy fz kh ki kj"><span id="24e9" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Function to predict ratings</em><br><strong class="kk hp">def</strong> predict(ratings, similarity, type='user'):<br>    <strong class="kk hp">if</strong> type == 'user':<br>        mean_user_rating = ratings.mean(axis=1)<br>        <em class="hl"># Use np.newaxis so that mean_user_rating has same format as ratings</em><br>        ratings_diff = (ratings - mean_user_rating[:, np.newaxis])<br>        pred = mean_user_rating[:, np.newaxis] + similarity.dot(ratings_diff) / np.array([np.abs(similarity).sum(axis=1)]).T<br>    <strong class="kk hp">elif</strong> type == 'item':<br>        pred = ratings.dot(similarity) / np.array([np.abs(similarity).sum(axis=1)])<br>    <strong class="kk hp">return</strong> pred</span></pre><h2 id="8ebb" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Evaluation</strong></h2><p id="5160" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">There are many evaluation metrics but one of the most popular metric used to evaluate accuracy of predicted ratings is <strong class="gz hp">Root Mean Squared Error (RMSE)</strong>. I will use the <strong class="gz hp">mean_square_error (MSE)</strong> function from sklearn, where the RMSE is just the square root of MSE. I’ll use the scikit-learn’s <strong class="gz hp">mean squared error</strong> function as my validation metric. Comparing user- and item-based collaborative filtering, it looks like user-based collaborative filtering gives a better result.</p><pre class="fv fw fx fy fz kh ki kj"><span id="2823" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><strong class="kk hp">from</strong> <strong class="kk hp">sklearn.metrics</strong> <strong class="kk hp">import</strong> mean_squared_error<br><strong class="kk hp">from</strong> <strong class="kk hp">math</strong> <strong class="kk hp">import</strong> sqrt<br><br><em class="hl"># Function to calculate RMSE</em><br><strong class="kk hp">def</strong> rmse(pred, actual):<br>    <em class="hl"># Ignore nonzero terms.</em><br>    pred = pred[actual.nonzero()].flatten()<br>    actual = actual[actual.nonzero()].flatten()<br>    <strong class="kk hp">return</strong> sqrt(mean_squared_error(pred, actual))</span><span id="2e38" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph=""><em class="hl"># Predict ratings on the training data with both similarity score</em><br>user_prediction = predict(train_data_matrix, user_correlation, type='user')<br>item_prediction = predict(train_data_matrix, item_correlation, type='item')</span><span id="6af4" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph=""><em class="hl"># RMSE on the train data</em><br>print('User-based CF RMSE: ' + str(rmse(user_prediction, train_data_matrix)))<br>print('Item-based CF RMSE: ' + str(rmse(item_prediction, train_data_matrix)))</span><span id="7bb5" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph="">## Output<br>User-based CF RMSE: 699.9584792778463<br>Item-based CF RMSE: 114.97271725933925</span></pre><p id="c005" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">RMSE of training of model is a metric which measure how much the signal and the noise is explained by the model. I noticed that my RMSE is quite big. I suppose I might have overfitted the training data.</p><p id="9cbc" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Overall, <strong class="gz hp">Memory-based Collaborative Filtering</strong> is easy to implement and produce reasonable prediction quality. However, there are some drawback of this approach:</p><ul class=""><li id="bcb4" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk hm hn ho" data-selectable-paragraph="">It doesn’t address the well-known cold-start problem, that is when new user or new item enters the system.</li><li id="a4f2" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">It can’t deal with sparse data, meaning it’s hard to find users that have rated the same items.</li><li id="4c72" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">It suffers when new users or items that don’t have any ratings enter the system.</li><li id="ab9a" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">It tends to recommend popular items.</li></ul><p id="98dd" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph=""><strong class="gz hp">Note:</strong> The complete code for content-based and memory-based collaborative filtering can be found in <a href="https://github.com/khanhnamle1994/movielens/blob/master/Content_Based_and_Collaborative_Filtering_Models.ipynb" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">this Jupyter Notebook</a>.</p><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp la"><div class="gh r bn gi"><div class="lb r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_PfgYi6hg02TDM0GknVa2nQ.png" width="975" height="597" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="975" height="597" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1950/1*PfgYi6hg02TDM0GknVa2nQ.png" width="975" height="597" role="presentation"/></noscript></div></div></div></div></figure><h1 id="7acf" class="ih ii co at as ij ik il im in io ip iq ir is it iu" data-selectable-paragraph=""><strong class="bw">3 — Matrix Factorization</strong></h1><p id="f60d" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">In the previous attempt, I have used memory-based collaborative filtering to make movie recommendations from users’ ratings data. I can only try them on a very small data sample (20,000 ratings), and ended up getting pretty high Root Mean Squared Error (bad recommendations). Memory-based collaborative filtering approaches that compute distance relationships between items or users have these two major issues:</p><ol class=""><li id="d4f6" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk jq hn ho" data-selectable-paragraph="">It doesn’t scale particularly well to massive datasets, especially for real-time recommendations based on user behavior similarities — which takes a lot of computations.</li><li id="4612" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk jq hn ho" data-selectable-paragraph="">Ratings matrices may be overfitting to noisy representations of user tastes and preferences. When we use distance based “neighborhood” approaches on raw data, we match to sparse low-level details that we assume represent the user’s preference vector instead of the vector itself.</li></ol><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="do dp lc"><div class="gh r bn gi"><div class="ld r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_bWAAyciKq580ArTix_O3nw.jpeg" width="638" height="479" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="638" height="479" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1276/1*bWAAyciKq580ArTix_O3nw.jpeg" width="638" height="479" role="presentation"/></noscript></div></div></div></figure><p id="4076" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Thus I’d need to apply <strong class="gz hp">Dimensionality Reduction</strong> technique to derive the tastes and preferences from the raw data, otherwise known as doing low-rank matrix factorization. Why reduce dimensions?</p><ul class=""><li id="ddae" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk hm hn ho" data-selectable-paragraph="">I can discover hidden correlations / features in the raw data.</li><li id="ac91" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">I can remove redundant and noisy features that are not useful.</li><li id="a858" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">I can interpret and visualize the data easier.</li><li id="ccb3" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">I can also access easier data storage and processing.</li></ul><h2 id="1076" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Math</strong></h2><p id="8b1a" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph=""><strong class="gz hp"><em class="hl">Model-based Collaborative Filtering</em></strong> is based on <strong class="gz hp"><em class="hl">matrix factorization (MF)</em></strong> which has received greater exposure, mainly as an unsupervised learning method for latent variable decomposition and dimensionality reduction. Matrix factorization is widely used for recommender systems where it can deal better with scalability and sparsity than Memory-based CF:</p><ul class=""><li id="791b" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk hm hn ho" data-selectable-paragraph="">The goal of MF is to learn the latent preferences of users and the latent attributes of items from known ratings (learn features that describe the characteristics of ratings) to then predict the unknown ratings through the dot product of the latent features of users and items.</li><li id="42e8" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">When you have a very sparse matrix, with a lot of dimensions, by doing matrix factorization, you can restructure the user-item matrix into low-rank structure, and you can represent the matrix by the multiplication of two low-rank matrices, where the rows contain the latent vector.</li><li id="1aaa" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">You fit this matrix to approximate your original matrix, as closely as possible, by multiplying the low-rank matrices together, which fills in the entries missing in the original matrix.</li></ul><p id="20c0" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">A well-known matrix factorization method is <strong class="gz hp"><em class="hl">Singular value decomposition (SVD)</em></strong>. At a high level, SVD is an algorithm that decomposes a matrix A into the best lower rank (i.e. smaller/simpler) approximation of the original matrix A. Mathematically, it decomposes A into a two unitary matrices and a diagonal matrix:</p><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp le"><div class="gh r bn gi"><div class="lf r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_W4MnB2hyvgqedLmwJLrpqw.png" width="2543" height="1421" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="2543" height="1421" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/5086/1*W4MnB2hyvgqedLmwJLrpqw.png" width="2543" height="1421" role="presentation"/></noscript></div></div></div></div></figure><p id="26bd" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">where A is the input data matrix (users’s ratings), U is the left singular vectors (user “features” matrix), Sum is the diagonal matrix of singular values (essentially weights/strengths of each concept), and V^T is the right singular vectors (movie “features” matrix). U and V^T are column orthonormal, and represent different things: U represents how much users “like” each feature and V^T represents how relevant each feature is to each movie.</p><p id="82b5" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">To get the lower rank approximation, I take these matrices and keep only the top k features, which can be thought of as the underlying tastes and preferences vectors.</p><p id="dc02" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph=""><strong class="gz hp">The Code</strong></p><p id="ad23" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Scipy and Numpy both have functions to do the singular value decomposition. I’m going to use the Scipy function <em class="hl">svds</em> because it let’s me choose how many latent factors I want to use to approximate the original ratings matrix (instead of having to truncate it after).</p><pre class="fv fw fx fy fz kh ki kj"><span id="42ae" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><strong class="kk hp">from</strong> <strong class="kk hp">scipy.sparse.linalg</strong> <strong class="kk hp">import</strong> svds <br>U, sigma, Vt = svds(Ratings_demeaned, k = 50)</span></pre><p id="7a4b" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">As I’m going to leverage matrix multiplication to get predictions, I’ll convert the Sum (now are values) to the diagonal matrix form.</p><pre class="fv fw fx fy fz kh ki kj"><span id="adcd" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">sigma = np.diag(sigma)</span></pre><p id="698c" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">I now have everything I need to make movie ratings predictions for every user. I can do it all at once by following the math and matrix multiply U, Sum, and V^T back to get the rank k = 50 approximation of A.</p><p id="d0fc" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">But first, I need to add the user means back to get the actual star ratings prediction.</p><pre class="fv fw fx fy fz kh ki kj"><span id="d757" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">all_user_predicted_ratings = np.dot(np.dot(U, sigma), Vt) + user_ratings_mean.reshape(-1, 1)</span></pre><p id="b80c" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">With the predictions matrix for every user, I can build a function to recommend movies for any user. I return the list of movies the user has already rated, for the sake of comparison.</p><pre class="fv fw fx fy fz kh ki kj"><span id="d942" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">preds = pd.DataFrame(all_user_predicted_ratings, columns = Ratings.columns)</span></pre><p id="999f" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Now I write a function to return the movies with the highest predicted rating that the specified user hasn’t already rated.</p><pre class="fv fw fx fy fz kh ki kj"><span id="e5dd" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><strong class="kk hp">def</strong> recommend_movies(predictions, userID, movies, original_ratings, num_recommendations):<br>    <br>    <em class="hl"># Get and sort the user's predictions</em><br>    user_row_number = userID - 1 <em class="hl"># User ID starts at 1, not 0</em><br>    sorted_user_predictions = preds.iloc[user_row_number].sort_values(ascending=False) <em class="hl"># User ID starts at 1</em><br>    <br>    <em class="hl"># Get the user's data and merge in the movie information.</em><br>    user_data = original_ratings[original_ratings.user_id == (userID)]<br>    user_full = (user_data.merge(movies, how = 'left', left_on = 'movie_id', right_on = 'movie_id').<br>                     sort_values(['rating'], ascending=False)<br>                 )<br>    <br>    <em class="hl"># Recommend the highest predicted rating movies that the user hasn't seen yet.</em><br>    recommendations = (movies[~movies['movie_id'].isin(user_full['movie_id'])].<br>         merge(pd.DataFrame(sorted_user_predictions).reset_index(), how = 'left',<br>               left_on = 'movie_id',<br>               right_on = 'movie_id').<br>         rename(columns = {user_row_number: 'Predictions'}).<br>         sort_values('Predictions', ascending = False).<br>                       iloc[:num_recommendations, :-1]<br>                      )<br><br>    <strong class="kk hp">return</strong> user_full, recommendations</span></pre><h2 id="164f" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Evaluation</strong></h2><p id="046d" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">Instead of doing evaluation manually like the last time, I will use the <a href="https://pypi.python.org/pypi/scikit-surprise" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow"><em class="hl">Surprise</em></a> library that provided various ready-to-use powerful prediction algorithms including (SVD) to evaluate its RMSE (Root Mean Squared Error) on the MovieLens dataset. It is a Python scikit building and analyzing recommender systems.</p><pre class="fv fw fx fy fz kh ki kj"><span id="9be1" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Import libraries from Surprise package</em><br><strong class="kk hp">from</strong> <strong class="kk hp">surprise</strong> <strong class="kk hp">import</strong> Reader, Dataset, SVD, evaluate<br><br><em class="hl"># Load Reader library</em><br>reader = Reader()<br><br><em class="hl"># Load ratings dataset with Dataset library</em><br>data = Dataset.load_from_df(ratings[['user_id', 'movie_id', 'rating']], reader)<br><br><em class="hl"># Split the dataset for 5-fold evaluation</em><br>data.split(n_folds=5)</span><span id="b8f6" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph=""><em class="hl"># Use the SVD algorithm.</em><br>svd = SVD()<br><br><em class="hl"># Compute the RMSE of the SVD algorithm.</em><br>evaluate(svd, data, measures=['RMSE'])</span></pre><p id="ca72" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">I get a mean <em class="hl">Root Mean Square Error</em> of 0.8736 which is pretty good.</p><h2 id="82e2" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Recommendation</strong></h2><p id="33e1" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">Let’s try to recommend 20 movies for user with ID 1310.</p><pre class="fv fw fx fy fz kh ki kj"><span id="433f" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">predictions = recommend_movies(preds, 1310, movies, ratings, 20)</span><span id="15ae" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph="">predictions</span></pre><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp lg"><div class="gh r bn gi"><div class="lh r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_1NNP0ayB8_HbMChzoYv-pw.png" width="1344" height="1222" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="1344" height="1222" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/2688/1*1NNP0ayB8_HbMChzoYv-pw.png" width="1344" height="1222" role="presentation"/></noscript></div></div></div></div></figure><p id="83ee" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">These look like pretty good recommendations. It’s good to see that, although I didn’t actually use the genre of the movie as a feature, the truncated matrix factorization features “picked up” on the underlying tastes and preferences of the user. I’ve recommended some comedy, drama, and romance movies — all of which were genres of some of this user’s top rated movies.</p><p id="87b8" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph=""><strong class="gz hp">Note:</strong> The complete code for SVD Matrix Factorization can be found in <a href="https://github.com/khanhnamle1994/movielens/blob/master/SVD_Model.ipynb" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">this Jupyter Notebook</a>.</p><h1 id="a7b9" class="ih ii co at as ij ik il im in io ip iq ir is it iu" data-selectable-paragraph=""><strong class="bw">4 — Deep Learning</strong></h1><h2 id="2fa9" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Math</strong></h2><p id="a852" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">The idea of using deep learning is similar to that of Model-Based Matrix Factorization. In matrix factorization, we decompose our original sparse matrix into product of 2 low rank orthogonal matrices. For deep learning implementation, we don’t need them to be orthogonal, we want our model to learn the values of embedding matrix itself. The user latent features and movie latent features are looked up from the embedding matrices for specific movie-user combination. These are the input values for further linear and non-linear layers. We can pass this input to multiple relu, linear or sigmoid layers and learn the corresponding weights by any optimization algorithm (Adam, SGD, etc.).</p><h2 id="fd55" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Code</strong></h2><p id="6656" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">Here are the main components of my neural network:</p><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp li"><div class="gh r bn gi"><div class="lj r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_OK0qufUIpzzJO1Ofqy5cqw.png" width="651" height="255" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="651" height="255" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/1302/1*OK0qufUIpzzJO1Ofqy5cqw.png" width="651" height="255" role="presentation"/></noscript></div></div></div></div></figure><ul class=""><li id="0125" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk hm hn ho" data-selectable-paragraph="">A left embedding layer that creates a Users by Latent Factors matrix.</li><li id="ca81" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">A right embedding layer that creates a Movies by Latent Factors matrix.</li><li id="da58" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">When the input to these layers are (i) a user id and (ii) a movie id, they’ll return the latent factor vectors for the user and the movie, respectively.</li><li id="4b9e" class="gx gy co at gz b ha hq hc hr he hs hg ht hi hu hk hm hn ho" data-selectable-paragraph="">A merge layer that takes the dot product of these two latent vectors to return the predicted rating.</li></ul><p id="3c46" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">This code is based on the approach outlined in <a href="http://www.fenris.org/" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">Alkahest</a>’s blog post <a href="http://www.fenris.org/2016/03/07/index-html" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">Collaborative Filtering in Keras</a>.</p><p id="0d6f" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">I then compile the model using Mean Squared Error (MSE) as the loss function and the AdaMax learning algorithm.</p><pre class="fv fw fx fy fz kh ki kj"><span id="29bd" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Define model</em><br>model = CFModel(max_userid, max_movieid, K_FACTORS)<br><em class="hl"># Compile the model using MSE as the loss function and the AdaMax learning algorithm</em><br>model.compile(loss='mse', optimizer='adamax')</span></pre><p id="2352" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Now I need to train the model. This step will be the most-time consuming one. In my particular case, for our dataset with nearly 1 million ratings, almost 6,000 users and 4,000 movies, I trained the model in roughly 6 minutes per epoch (30 epochs ~ 3 hours) inside my Macbook Laptop CPU. I spitted the training and validataion data with ratio of 90/10.</p><pre class="fv fw fx fy fz kh ki kj"><span id="8a1d" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Callbacks monitor the validation loss</em><br><em class="hl"># Save the model weights each time the validation loss has improved</em><br>callbacks = [EarlyStopping('val_loss', patience=2), <br>             ModelCheckpoint('weights.h5', save_best_only=True)]<br><br><em class="hl"># Use 30 epochs, 90% training data, 10% validation data </em><br>history = model.fit([Users, Movies], Ratings, nb_epoch=30, validation_split=.1, verbose=2, callbacks=callbacks)</span></pre><p id="3ac5" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">The next step is to actually predict the ratings a random user will give to a random movie. Below I apply the freshly trained deep learning model for all the users and all the movies, using 100 dimensional embeddings for each of them.</p><pre class="fv fw fx fy fz kh ki kj"><span id="cfd1" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Use the pre-trained model</em><br>trained_model = CFModel(max_userid, max_movieid, K_FACTORS)<br><em class="hl"># Load weights</em><br>trained_model.load_weights('weights.h5')</span></pre><p id="08c6" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">Here I define the function to predict user’s rating of unrated items.</p><pre class="fv fw fx fy fz kh ki kj"><span id="bb2e" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Function to predict the ratings given User ID and Movie ID</em><br><strong class="kk hp">def</strong> predict_rating(user_id, movie_id):<br>    <strong class="kk hp">return</strong> trained_model.rate(user_id - 1, movie_id - 1)</span></pre><h2 id="104e" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Evaluation</strong></h2><p id="36c0" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">During the training process above, I saved the model weights each time the validation loss has improved. Thus, I can use that value to calculate the best validation Root Mean Square Error.</p><pre class="fv fw fx fy fz kh ki kj"><span id="0942" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph=""><em class="hl"># Show the best validation RMSE</em><br>min_val_loss, idx = min((val, idx) <strong class="kk hp">for</strong> (idx, val) <strong class="kk hp">in</strong> enumerate(history.history['val_loss']))</span><span id="dc38" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph=""><strong class="kk hp">print</strong> 'Minimum RMSE at epoch', '{:d}'.format(idx+1), '=', '{:.4f}'.format(math.sqrt(min_val_loss))</span><span id="b848" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph="">## Output<br>Minimum RMSE at epoch 17 = 0.8616</span></pre><p id="e947" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">The best validation loss is <em class="hl">0.7424</em> at epoch 17. Taking the square root of that number, I got the RMSE value of <em class="hl">0.8616</em>, which is better than the RMSE from the SVD Model (<em class="hl">0.8736</em>).</p><h2 id="0c63" class="jr ii co at as ij js jt ju jv jw jx jy jz ka kb kc" data-selectable-paragraph=""><strong class="bw">The Recommendation</strong></h2><p id="460e" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">Here I make a recommendation list of unrated 20 movies sorted by prediction value for user ID 2000. Let’s see it.</p><pre class="fv fw fx fy fz kh ki kj"><span id="8ab0" class="jr ii co at kk b bl kl km r kn" data-selectable-paragraph="">recommendations = ratings[ratings['movie_id'].isin(user_ratings['movie_id']) == False][['movie_id']].drop_duplicates()</span><span id="9bbf" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph="">recommendations['prediction'] = recommendations.apply(<strong class="kk hp">lambda</strong> x: predict_rating(TEST_USER, x['movie_id']), axis=1)</span><span id="abc1" class="jr ii co at kk b bl kv kw kx ky kz km r kn" data-selectable-paragraph="">recommendations.sort_values(by='prediction', ascending=False).merge(movies, on='movie_id', how='inner',<br>suffixes=['_u', '_m']).head(20)</span></pre><figure class="fv fw fx fy fz fu do dp paragraph-image"><div class="ga gb bn gc ak"><div class="do dp lk"><div class="gh r bn gi"><div class="ll r"><div class="op tj ds t u ge ak bf gf gg"><img class="ds t u ge ak gk gl gm" src="./movie_files/1_TV-g8yLa1JhIr6c9ILUDpA.png" width="1246" height="1224" role="presentation"></div><img class="bm gd ds t u ge ak gn" width="1246" height="1224" role="presentation"><noscript><img class="ds t u ge ak" src="https://miro.medium.com/max/2492/1*TV-g8yLa1JhIr6c9ILUDpA.png" width="1246" height="1224" role="presentation"/></noscript></div></div></div></div></figure><p id="edec" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph="">This model performed better than all the approaches I attempted before (content-based, user-item similarity collaborative filtering, SVD). I can certainly improve this model’s performance by making it deeper with more linear and non-linear layers.</p><p id="7938" class="gx gy co at gz b ha hb hc hd he hf hg hh hi hj hk" data-selectable-paragraph=""><strong class="gz hp">Note:</strong> The complete code for Deep Learning Model can be found in <a href="https://github.com/khanhnamle1994/movielens/blob/master/Deep_Learning_Model.ipynb" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">this Jupyter Notebook</a>.</p><h1 id="eb85" class="ih ii co at as ij ik il im in io ip iq ir is it iu" data-selectable-paragraph=""><strong class="bw">Last Takeaway</strong></h1><p id="0694" class="gx gy co at gz b ha iv hc iw he ix hg iy hi iz hk" data-selectable-paragraph="">Recommendation Engine is your companion and advisor to help you make the right choices by providing you tailored options and creating a personalized experience for you. It is beyond any doubt that recommendation engines are getting popular and critical in the new age of things. It is going to be in your best interest to learn to use them for businesses to be more competitive and consumers to be more efficient. I hope that this post has been helpful for you to learn about the 4 different approaches to build your own movie recommendation system. You can view all the source code in my GitHub repo at this link (<a href="https://github.com/khanhnamle1994/movielens" class="bq de gt gu gv gw" target="_blank" rel="noopener nofollow">https://github.com/khanhnamle1994/movielens</a>). Let me know if you have any questions or suggestions on improvement!</p></div></div></section></div></article><div class="op dw lm s ak ln lo lp" data-test-id="post-sidebar"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="lq n dr"><div class="wq"><div class="lr ls lt n"><div class="n o"><div class="lu r bn"><div class=""><button class="bx lv lw lx ly lz ma mb mc md me"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="mf r"><div class="mg"><h4 class="as fb bl au ax"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf">1K </button></h4></div></div></div></div><div class="mc"><div><div class="bh"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div><div class="op wq lm s mh ew mi mj lo mk"></div><div><div class="ml fu n dr p"><div class="n p"><div class="ac ae af ag ah ec aj ak"><div class="n mm"></div><div class="n o mm"></div><div class="mn r"><ul class="bx by"><li class="bh mo mp mq"><a href="https://medium.com/tag/recommendation-system" class="mr ms de ax r ki mt a b ft">Recommendation System</a></li><li class="bh mo mp mq"><a href="https://medium.com/tag/movies" class="mr ms de ax r ki mt a b ft">Movies</a></li><li class="bh mo mp mq"><a href="https://medium.com/tag/machine-learning" class="mr ms de ax r ki mt a b ft">Machine Learning</a></li><li class="bh mo mp mq"><a href="https://medium.com/tag/personalization" class="mr ms de ax r ki mt a b ft">Personalization</a></li><li class="bh mo mp mq"><a href="https://medium.com/tag/predictions" class="mr ms de ax r ki mt a b ft">Predictions</a></li></ul></div><div class="mu n mv ab"><div class="n o"><div class="cl r bn"><div class=""><div class="c mw dh n o mx bn my mz na nb nc nd ne nf ng nh ni nj nk nl"><button class="bx lv lw lx ly lz nm mb o gn dh n p nn u ge ds t ak mc md me no"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></button></div></div></div><div class="mf r"><div class="mg"><h4 class="as fb bl au co"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf">1K claps</button></h4></div></div></div><div class="n o"><div class="np r ar g"><a href="https://medium.com/p/bbec857b8223/share/twitter?source=post_actions_footer---------------------------" class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf" target="_blank" rel="noopener"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></a></div><div class="np r ar g"><a href="https://medium.com/p/bbec857b8223/share/facebook?source=post_actions_footer---------------------------" class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf" target="_blank" rel="noopener"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></a></div><div class="np ap aq"><div class="bh"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" class="q"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="np r ar"><div class="mc"><div><div class="bh"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div><div class="bh"><div class="r ar"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="q"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div><div class="nq nr ns mn r ab"><div class="nt nu r bn"><span class="r nv an nw"><div class="r ds nx ny"><a rel="noopener" href="https://medium.com/@james_aka_yale?source=follow_footer--------------------------follow_footer-"><div class="bn nz oa"><div class="er n es o p ds et eu ev ew ex dw"><svg width="91" height="91" viewBox="0 0 91 91"><path fill-rule="evenodd" clip-rule="evenodd" d="M45.5 1.4c-17.14 0-32 9.95-39.25 24.5L5 25.28C12.47 10.28 27.8 0 45.5 0S78.53 10.29 86 25.28l-1.25.62C77.5 11.35 62.65 1.4 45.5 1.4zM6.25 65.1c7.25 14.55 22.1 24.5 39.25 24.5 17.14 0 32-9.95 39.25-24.5l1.25.62C78.53 80.72 63.2 91 45.5 91S12.47 80.71 5 65.72l1.25-.62z"></path></svg></div><img alt="James Le" class="r dh oa nz" src="./movie_files/1_kbXSc2-EEtk9ekKq36woIQ(1).jpeg" width="80" height="80"></div></a></div><span class="r"><div class="ob r oc"><p class="as fb ft au ax od oe">Written by</p></div><div class="ob of n oc"><div class="ak n o mv"><h2 class="as ij og oh co"><a class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf" rel="noopener" href="https://medium.com/@james_aka_yale?source=follow_footer--------------------------follow_footer-">James Le</a></h2><div class="r g"><button class="cn fj fk fl fm fn fo bz cw fp fq fr da as b at au av aw db dc dd bh de cc">Following</button></div></div></div></span></span><div class="ob oi r oc aq"><div class="oj r"><h4 class="as fb ok ol ax">Blue Ocean Thinker (https://jameskle.com/)</h4></div><div class="ap om aq"><button class="cn fj fk fl fm fn fo bz cw fp fq fr da as b at au av aw db dc dd bh de cc">Following</button></div></div></div></div><div class="on nr r ab"><a href="https://medium.com/p/bbec857b8223/responses/show?source=follow_footer--------------------------follow_footer-" class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf" rel="noopener"><span class="oo op ly"><div class="kh or da r gq aq"><span class="oq">See responses (3)</span></div></span></a></div></div></div><div class="os r ot ab"><div class="n p"><div class="ac ae af ag ah ai aj ak"><div class="tn r to"><div class="qe tp nt r"><h2 class="as ij tq tr co">More From Medium</h2></div><div class="ts n es mm tt tu tv tw tx ty tz ua ub uc ud ue uf ug uh"><div class="ui uj uk hw ul um un hy uo up uq ia ur us ut uu uv uw ux uy uz"><div class="ak ge"><div class="r va"><div class="vb vc tt tu tv vd ve tw tx ty vf vg tz ua ub vh vi uc ud ue vj vk uf ug uh n mm"><div class="ui uj uk hw ul um vl vm uo up vn vo ur us vp vq uv uw vr vs uz"><div class="vt r rj f"><h4 class="as fb bl au ax">More from James Le</h4></div><div class="bb r vu to"><a class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf r" rel="noopener" href="https://medium.com/cracking-the-data-science-interview/greedy-algorithm-and-dynamic-programming-a8c019928405?source=post_recirc---------0------------------"><div class="vv bn"><div class="ge ds ak"><div class="vw r vx vy ge ak vz wa"></div></div></div></a></div></div><div class="ui uj uk hw ul um vl vm uo up vn vo ur us vp vq uv uw vr vs uz"><div class="bb r"><div class="wb ap h wc"><h4 class="as fb bl au ax">More from James Le</h4></div><a rel="noopener" href="https://medium.com/cracking-the-data-science-interview/greedy-algorithm-and-dynamic-programming-a8c019928405?source=post_recirc---------0------------------"><h3 class="co q ef sc at wd we wf">Greedy Algorithm and Dynamic Programming</h3></a></div><div class="n o mv"><div class="ch r wg"><div class="o n"><div><a rel="noopener" href="https://medium.com/@james_aka_yale?source=post_recirc---------0------------------"><div class="bn wh wi"><div class="er n es o p ds et eu ev ew ex dw"><svg width="49" height="49" viewBox="0 0 49 49"><path fill-rule="evenodd" clip-rule="evenodd" d="M24.5 1.1c-9.39 0-17.53 5.55-21.51 13.66L2 14.28C6.15 5.82 14.66 0 24.5 0S42.85 5.82 47 14.28l-.99.48C42.03 6.65 33.9 1.1 24.5 1.1zM2.99 34.24C6.97 42.35 15.1 47.9 24.5 47.9c9.39 0 17.53-5.55 21.51-13.66l.99.48C42.85 43.18 34.34 49 24.5 49S6.15 43.18 2 34.72l.99-.48z"></path></svg></div><img alt="James Le" class="r dh wi wh" src="./movie_files/1_kbXSc2-EEtk9ekKq36woIQ(2).jpeg" width="40" height="40"></div></a></div><div class="ey ak r"><div class="n"><div style="flex: 1 1 0%;"><span class="as b at au av aw r co q"><div class="dk n o fa"><span class="as fb bl au bf fc be fd fe ff co"><a class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener" href="https://medium.com/@james_aka_yale?source=post_recirc---------0------------------">James Le</a><span> in <a href="https://medium.com/cracking-the-data-science-interview?source=post_recirc---------0------------------" class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener">Cracking The Data Science Interview</a></span></span></div></span></div></div><span class="as b at au av aw r ax ay"><span class="as fb bl au bf fc be fd fe ff ax"><div><a class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener" href="https://medium.com/cracking-the-data-science-interview/greedy-algorithm-and-dynamic-programming-a8c019928405?source=post_recirc---------0------------------">Oct 16, 2018</a> · 15 min read</div></span></span></div></div></div><div class="n o"><div class="n o"><div class="lu r bn"><div class=""><button class="bx lv lw lx ly lz ma qj mc md me"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="mf r"><div class="mg"><h4 class="as fb bl au ax">1.5K </h4></div></div></div><div class="wj ey ch wk wl r"></div><div class="mc"><div><div class="bh"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="ui uj uk hw ul um un hy uo up uq ia ur us ut uu uv uw ux uy uz"><div class="ak ge"><div class="r va"><div class="vb vc tt tu tv vd ve tw tx ty vf vg tz ua ub vh vi uc ud ue vj vk uf ug uh n mm"><div class="ui uj uk hw ul um vl vm uo up vn vo ur us vp vq uv uw vr vs uz"><div class="vt r rj f"><h4 class="as fb bl au ax">Related reads</h4></div><div class="bb r vu to"><a class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf r" rel="noopener" href="https://medium.com/@wwwbbb8510/python-implementation-of-baseline-item-based-collaborative-filtering-2ba7c8960590?source=post_recirc---------1------------------"><div class="vv bn"><div class="ge ds ak"><div class="wm r vx vy ge ak vz wa"></div></div></div></a></div></div><div class="ui uj uk hw ul um vl vm uo up vn vo ur us vp vq uv uw vr vs uz"><div class="bb r"><div class="wb ap h wc"><h4 class="as fb bl au ax">Related reads</h4></div><a rel="noopener" href="https://medium.com/@wwwbbb8510/python-implementation-of-baseline-item-based-collaborative-filtering-2ba7c8960590?source=post_recirc---------1------------------"><h3 class="co q ef sc at wd we wf">Python Implementation of Baseline Item-Based Collaborative Filtering</h3></a></div><div class="n o mv"><div class="ch r wg"><div class="o n"><div><a rel="noopener" href="https://medium.com/@wwwbbb8510?source=post_recirc---------1------------------"><img alt="王斌" class="r dh wi wh" src="./movie_files/0_9UVYDZXLvn5mcaiT_" width="40" height="40"></a></div><div class="ey ak r"><div class="n"><div style="flex: 1 1 0%;"><span class="as b at au av aw r co q"><div class="dk n o fa"><span class="as fb bl au bf fc be fd fe ff co"><a class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener" href="https://medium.com/@wwwbbb8510?source=post_recirc---------1------------------">王斌</a></span></div></span></div></div><span class="as b at au av aw r ax ay"><span class="as fb bl au bf fc be fd fe ff ax"><div><a class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener" href="https://medium.com/@wwwbbb8510/python-implementation-of-baseline-item-based-collaborative-filtering-2ba7c8960590?source=post_recirc---------1------------------">Apr 19, 2018</a> · 7 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="n o"><div class="n o"><div class="lu r bn"><div class=""><button class="bx lv lw lx ly lz ma qj mc md me"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="mf r"><div class="mg"><h4 class="as fb bl au ax">308 </h4></div></div></div><div class="wj ey ch wk wl r"></div><div class="mc"><div><div class="bh"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div><div class="ui uj uk hw ul um un hy uo up uq ia ur us ut uu uv uw ux uy uz"><div class="ak ge"><div class="r va"><div class="vb vc tt tu tv vd ve tw tx ty vf vg tz ua ub vh vi uc ud ue vj vk uf ug uh n mm"><div class="ui uj uk hw ul um vl vm uo up vn vo ur us vp vq uv uw vr vs uz"><div class="vt r rj f"><h4 class="as fb bl au ax">Related reads</h4></div><div class="bb r vu to"><a href="https://towardsdatascience.com/building-a-movie-recommendation-engine-using-pandas-e0a105ed6762?source=post_recirc---------2------------------" class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf r" rel="noopener"><div class="vv bn"><div class="ge ds ak"><div class="wn r vx vy ge ak vz wa"></div></div></div></a></div></div><div class="ui uj uk hw ul um vl vm uo up vn vo ur us vp vq uv uw vr vs uz"><div class="bb r"><div class="wb ap h wc"><h4 class="as fb bl au ax">Related reads</h4></div><a href="https://towardsdatascience.com/building-a-movie-recommendation-engine-using-pandas-e0a105ed6762?source=post_recirc---------2------------------" rel="noopener"><h3 class="co q ef sc at wd we wf">Building A Movie Recommendation Engine Using Pandas</h3></a></div><div class="n o mv"><div class="ch r wg"><div class="o n"><div><a rel="noopener" href="https://medium.com/@nishhit777?source=post_recirc---------2------------------"><img alt="Nishit Jain" class="r dh wi wh" src="./movie_files/1_yHqJWxESBEe-3X10e1mmHQ.jpeg" width="40" height="40"></a></div><div class="ey ak r"><div class="n"><div style="flex: 1 1 0%;"><span class="as b at au av aw r co q"><div class="dk n o fa"><span class="as fb bl au bf fc be fd fe ff co"><a class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener" href="https://medium.com/@nishhit777?source=post_recirc---------2------------------">Nishit Jain</a><span> in <a href="https://towardsdatascience.com/?source=post_recirc---------2------------------" class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener">Towards Data Science</a></span></span></div></span></div></div><span class="as b at au av aw r ax ay"><span class="as fb bl au bf fc be fd fe ff ax"><div><a href="https://towardsdatascience.com/building-a-movie-recommendation-engine-using-pandas-e0a105ed6762?source=post_recirc---------2------------------" class="bq br bs bt bu bv bw bx by bz fg cc cd ce cf" rel="noopener">Apr 21</a> · 10 min read<span style="padding-left: 4px;"><svg class="star-15px_svg__svgIcon-use" width="15" height="15" viewBox="0 0 15 15" style="margin-top: -2px;"><path d="M7.44 2.32c.03-.1.09-.1.12 0l1.2 3.53a.29.29 0 0 0 .26.2h3.88c.11 0 .13.04.04.1L9.8 8.33a.27.27 0 0 0-.1.29l1.2 3.53c.03.1-.01.13-.1.07l-3.14-2.18a.3.3 0 0 0-.32 0L4.2 12.22c-.1.06-.14.03-.1-.07l1.2-3.53a.27.27 0 0 0-.1-.3L2.06 6.16c-.1-.06-.07-.12.03-.12h3.89a.29.29 0 0 0 .26-.19l1.2-3.52z"></path></svg></span></div></span></span></div></div></div><div class="n o"><div class="n o"><div class="lu r bn"><div class=""><button class="bx lv lw lx ly lz ma qj mc md me"><svg width="25" height="25" viewBox="0 0 25 25"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="mf r"><div class="mg"><h4 class="as fb bl au ax">308 </h4></div></div></div><div class="wj ey ch wk wl r"></div><div class="mc"><div><div class="bh"><button class="bq br bs bt bu bv bw bx by bz ca cb cc cd ce cf"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="ou r ov ow"><section class="do dp ak dd r ox oy oz pa pb pc pd pe pf pg ph pi pj pk pl"><div class="pm pn nt n mv g"><div class="po n mv"><div class="pp r pq"><div class="pr r"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz ps pt cc cd pu pv" rel="noopener"><h4 class="pw px py as ij at ol pz qa r">Discover <!-- -->Medium</h4></a></div><span class="as b at au av aw r qb qc">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz cc cd pu pv qd" rel="noopener">Watch</a></span></div><div class="pp r pq"><div class="qe r"><a href="https://medium.com/topics?source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz ps pt cc cd pu pv" rel="noopener"><h4 class="pw px py as ij at ol pz qa r">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="as b at au av aw r qb qc">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz cc cd pu pv qd" rel="noopener">Explore</a></span></div><div class="pp r pq"><div class="pr r"><a href="https://medium.com/membership?source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz ps pt cc cd pu pv" rel="noopener"><h4 class="pw px py as ij at ol pz qa r">Become a member</h4></a></div><span class="as b at au av aw r qb qc">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://medium.com/membership?source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz cc cd pu pv qd" rel="noopener">Upgrade</a></span></div></div></div><div class="n o mv"><a href="https://medium.com/?source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz ps pt cc cd pu pv" rel="noopener"><svg height="22" width="112" viewBox="0 0 111.5 22" class="px"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="as b at au av aw r qb qc"><div class="qf qg n mv qh an"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz fg cc cd pu pv" rel="noopener">About</a><a href="https://help.medium.com/?source=post_page-----bbec857b8223----------------------" class="bq br bs bt bu bv bw bx by bz fg cc cd pu pv" rel="noopener">Help</a><a class="bq br bs bt bu bv bw bx by bz fg cc cd pu pv" rel="noopener" href="https://medium.com/policy/9db0094a1e0f?source=post_page-----bbec857b8223----------------------">Legal</a></div></span></div></section></div></div></div><script src="./movie_files/16180790160.js.download"></script><iframe src="./movie_files/a16180790160.html" hidden="" aria-hidden="true" tabindex="-1" title="Optimizely Internal Frame" height="0" width="0" style="display: none;"></iframe><script>window.__BUILD_ID__ = "development"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20191108-171029-9103289502","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"collector-medium.lightstep.com","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20191108-171029-9103289502"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","sentry":{"dsn":"https:\u002F\u002F589e367c28ca47b195ce200d1507d18b@sentry.io\u002F1423575","environment":"production"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io"]},"debug":{"requestId":"231c71f0-f92b-4e07-a997-ae7675e2ea0a","originalSpanCarrier":{"ot-tracer-spanid":"6ad2742f5649c733","ot-tracer-traceid":"0bb673f9382b7922","ot-tracer-sampled":"true"}},"session":{"user":{"id":"f1c280d0b1e6"},"xsrf":"qk4pVOwxg1GX"},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"showBranchBanner":null,"hasRenderedBranchBanner":null,"hideGoogleOneTap":false,"branchData":{"loaded":false},"currentLocation":"https:\u002F\u002Fmedium.com\u002F@james_aka_yale\u002Fthe-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223","host":"medium.com","hostname":"medium.com","referrer":"https:\u002F\u002Fwww.google.com\u002F","currentHash":""},"client":{"isBot":false,"isEu":false,"isNativeMedium":false,"isCustomDomain":false},"multiVote":{"clapsPerPost":{}},"metadata":{"faviconImageId":null}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY.variantFlags.0":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.3":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.4":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.5":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.6":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.7":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.9":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.10":{"name":"enable_app_flirty_thirty","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"enable_daily_read_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"enable_different_grid","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_feature_store_from_ranker","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_first_name_on_paywall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_inline_search_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_inline_search_popover_lite","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.29":{"name":"enable_kafka_events","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_limit_diversification_heuristic","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.35":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_lite_read_next","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagString","value":"sidebar"},"ROOT_QUERY.variantFlags.39":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_live_user_post_scoring","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_lo_scroll_away_metabar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_logged_out_homepage_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_membership_remove_section_a","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_more_branch_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_new_gdpr_partner_export","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_new_partner_dashboard","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_new_partner_payout_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_new_partner_program_copy_updates","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_new_partner_program_updates","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.55":{"name":"enable_new_paypal_billing_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_new_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_popular_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_popularity_feature_exp_retrain","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"enable_recs_all_posts_from_pub","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_rtr_channel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"enable_susi_font_changes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.68":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"enable_ticks_digest_promo","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.70":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.71":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.72":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.72.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.72.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.73":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.73.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.73.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.74":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.74.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.74.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.75":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.75.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.75.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.76":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.76.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.76.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.77":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.77.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.77.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.78":{"name":"rank_model","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.78.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.78.valueType":{"__typename":"VariantFlagString","value":"default"},"ROOT_QUERY.variantFlags.79":{"name":"redis_read_write_splitting","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.79.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.79.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.80":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.80.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.80.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.81":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.81.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.81.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap"},"ROOT_QUERY.variantFlags.82":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.82.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.82.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY":{"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.72","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.73","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.74","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.75","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.76","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.77","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.78","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.79","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.80","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.81","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.82","typename":"VariantFlag"}],"viewer":{"type":"id","generated":false,"id":"User:f1c280d0b1e6","typename":"User"},"meterPost({\"postId\":\"bbec857b8223\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"bbec857b8223\"})":{"type":"id","generated":false,"id":"Post:bbec857b8223","typename":"Post"},"notificationsConnection({})":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({})","typename":"NotificationsConnection"},"notificationStatus":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationStatus","typename":"NotificationStatus"}},"User:f1c280d0b1e6":{"id":"f1c280d0b1e6","username":"saicharanars","name":"Sai Charan Arishanapally","imageId":"2*5hGxbnmvqtZYznx3jDcYMA.jpeg","mediumMemberAt":0,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"saicharanars@gmail.com","unverifiedEmail":"","createdAt":1552567573446,"__typename":"User"},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":["bbec857b8223"]},"maxUnlockCount":3,"unlocksRemaining":2},"Post:bbec857b8223":{"__typename":"Post","visibility":"LOCKED","latestPublishedVersion":"1125c416fdb8","collection":null,"id":"bbec857b8223","creator":{"type":"id","generated":false,"id":"User:52aa38cb8e25","typename":"User"},"isLocked":true,"lockedSource":"LOCKED_POST_SOURCE_UGC","sequence":null,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@james_aka_yale\u002Fthe-4-recommendation-engines-that-can-predict-your-movie-tastes-bbec857b8223","canonicalUrl":"","content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":true,"id":"$Post:bbec857b8223.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})","typename":"PostContent"},"firstPublishedAt":1524397736808,"isPublished":true,"layerCake":4,"primaryTopic":null,"title":"The 4 Recommendation Engines That Can Predict Your Movie Tastes","isLimitedState":false,"pendingCollection":null,"shareKey":null,"statusForCollection":null,"readingTime":17.77735849056604,"license":"ALL_RIGHTS_RESERVED","allowResponses":true,"tags":[{"type":"id","generated":false,"id":"Tag:recommendation-system","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:movies","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:machine-learning","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:personalization","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:predictions","typename":"Tag"}],"viewerClapCount":0,"readingList":"READING_LIST_NONE","clapCount":1023,"voterCount":176,"recommenders":[],"responsesCount":3,"collaborators":[],"translationSourcePost":null,"newsletterId":"","inResponseToPostResult":null,"inResponseToMediaResource":null,"curationEligibleAt":0,"audioVersionUrl":"","socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1524906473719,"previewContent":{"type":"id","generated":true,"id":"$Post:bbec857b8223.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:0*ox2NxC7NrvEs31a2.","typename":"ImageMetadata"},"updatedAt":1528979963892,"topics":[{"type":"id","generated":false,"id":"data-science","typename":"Topic"}],"isSuspended":false},"User:52aa38cb8e25":{"id":"52aa38cb8e25","__typename":"User","isSuspended":false,"allowNotes":true,"name":"James Le","isFollowing":true,"username":"james_aka_yale","bio":"Blue Ocean Thinker (https:\u002F\u002Fjameskle.com\u002F)","imageId":"1*kbXSc2-EEtk9ekKq36woIQ.jpeg","mediumMemberAt":1554188400000,"isBlocking":false,"isPartnerProgramEnrolled":false,"twitterScreenName":"james_aka_yale"},"$Post:bbec857b8223.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:bbec857b8223.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel","typename":"RichText"}},"$Post:bbec857b8223.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0":{"name":"665b","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:bbec857b8223.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:bbec857b8223.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_61","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_62","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_63","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_64","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_65","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_66","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_67","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_68","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_69","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_70","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_71","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_72","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_73","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_74","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_75","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_76","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_77","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_78","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_79","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_80","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_81","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_82","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_83","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_84","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_85","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_86","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_87","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_88","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_89","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_90","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_91","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_92","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_93","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_94","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_95","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_96","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_97","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_98","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_99","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_100","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_101","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_102","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_103","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_104","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_105","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_106","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_107","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_108","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_109","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_110","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_111","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_112","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_113","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_114","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_115","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_116","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_117","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_118","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_119","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_120","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_121","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_122","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_123","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_124","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_125","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_126","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_127","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_128","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_129","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_130","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_131","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_132","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_133","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_134","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_135","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_136","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_137","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_138","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_139","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_140","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_141","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_142","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_143","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_144","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_145","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_146","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_147","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_148","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_149","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_150","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_151","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_152","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_153","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_154","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_155","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_156","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_157","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_158","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_159","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_160","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_161","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_162","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_163","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_164","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_165","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_166","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_167","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_168","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_169","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_170","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_171","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_172","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_173","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_174","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_175","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_176","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_177","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_178","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_179","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:1125c416fdb8_180","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:1125c416fdb8_0":{"id":"1125c416fdb8_0","name":"5014","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"The 4 Recommendation Engines That Can Predict Your Movie Tastes","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_1":{"id":"1125c416fdb8_1","name":"10cf","__typename":"Paragraph","type":"IMG","href":null,"layout":"FULL_WIDTH","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*ox2NxC7NrvEs31a2.","typename":"ImageMetadata"},"text":"Photo by JESHOOTS.COM on Unsplash","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_1.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_1.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ox2NxC7NrvEs31a2.":{"id":"0*ox2NxC7NrvEs31a2.","originalHeight":4160,"originalWidth":6240,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_1.markups.0":{"type":"A","start":9,"end":21,"href":"https:\u002F\u002Funsplash.com\u002F@jeshoots?utm_source=medium&utm_medium=referral","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_1.markups.1":{"type":"A","start":25,"end":33,"href":"https:\u002F\u002Funsplash.com?utm_source=medium&utm_medium=referral","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_2":{"id":"1125c416fdb8_2","name":"a208","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"“What movie should I watch this evening?”","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_2.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_2.markups.0":{"type":"EM","start":1,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_3":{"id":"1125c416fdb8_3","name":"5f06","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Have you ever had to answer this question at least once when you came home from work? As for me — yes, and more than once. From Netflix to Hulu, the need to build robust movie recommendation systems is extremely important given the huge demand for personalized content of modern consumers.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_4":{"id":"1125c416fdb8_4","name":"12ae","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"An example of recommendation system is such as this:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_5":{"id":"1125c416fdb8_5","name":"fd5a","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"User A watches Game of Thrones and Breaking Bad.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_5.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_5.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_5.markups.0":{"type":"STRONG","start":15,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_5.markups.1":{"type":"STRONG","start":35,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_6":{"id":"1125c416fdb8_6","name":"13b1","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"User B does search on Game of Thrones, then the system suggests Breaking Bad from data collected about user A.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_6.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_6.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_6.markups.0":{"type":"STRONG","start":22,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_6.markups.1":{"type":"STRONG","start":64,"end":76,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_7":{"id":"1125c416fdb8_7","name":"b071","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Recommendation systems are used not only for movies, but on multiple other products and services like Amazon (Books, Items), Pandora\u002FSpotify (Music), Google (News, Search), YouTube (Videos) etc.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_8":{"id":"1125c416fdb8_8","name":"a011","__typename":"Paragraph","type":"IMG","href":null,"layout":"OUTSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*dMR3xmufnmKiw4crlisQUA.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*dMR3xmufnmKiw4crlisQUA.png":{"id":"1*dMR3xmufnmKiw4crlisQUA.png","originalHeight":998,"originalWidth":1600,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_9":{"id":"1125c416fdb8_9","name":"1bff","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In this post, I will show you how to implement the 4 different movie recommendation approaches and evaluate them to see which one has the best performance.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_10":{"id":"1125c416fdb8_10","name":"1f24","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"The MovieLens Dataset","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_10.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_10.markups.0":{"type":"STRONG","start":0,"end":21,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_11":{"id":"1125c416fdb8_11","name":"852c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The dataset that I’m working with is MovieLens, one of the most common datasets that is available on the internet for building a Recommender System. The version of the dataset that I’m working with (1M) contains 1,000,209 anonymous ratings of approximately 3,900 movies made by 6,040 MovieLens users who joined MovieLens in 2000.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_11.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_11.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_11.markups.0":{"type":"A","start":37,"end":46,"href":"https:\u002F\u002Fgrouplens.org\u002Fdatasets\u002Fmovielens\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_11.markups.1":{"type":"A","start":199,"end":201,"href":"https:\u002F\u002Fgrouplens.org\u002Fdatasets\u002Fmovielens\u002F1m\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_12":{"id":"1125c416fdb8_12","name":"cf11","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"After processing the data and doing some exploratory analysis, here are the most interesting features of this dataset:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_13":{"id":"1125c416fdb8_13","name":"ca51","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s a word-cloud visualization of the movie titles:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_13.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_13.markups.0":{"type":"STRONG","start":41,"end":53,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_14":{"id":"1125c416fdb8_14","name":"5a93","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*qMrcVoRVNmxgHODwyYGE_w.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*qMrcVoRVNmxgHODwyYGE_w.png":{"id":"1*qMrcVoRVNmxgHODwyYGE_w.png","originalHeight":475,"originalWidth":941,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_15":{"id":"1125c416fdb8_15","name":"704d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Beautiful, isn’t it? I can recognize that there are a lot of movie franchises in this dataset, as evidenced by words like II and III… In addition to that, Day, Love, Life, Time, Night, Man, Dead, American are among the most commonly occuring words.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.6","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.7","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.8","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_15.markups.9","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_15.markups.0":{"type":"EM","start":122,"end":124,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.1":{"type":"EM","start":129,"end":132,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.2":{"type":"EM","start":155,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.3":{"type":"EM","start":160,"end":164,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.4":{"type":"EM","start":166,"end":170,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.5":{"type":"EM","start":172,"end":176,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.6":{"type":"EM","start":178,"end":183,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.7":{"type":"EM","start":185,"end":188,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.8":{"type":"EM","start":190,"end":194,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_15.markups.9":{"type":"EM","start":196,"end":204,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_16":{"id":"1125c416fdb8_16","name":"1e96","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s a distribution of the user ratings:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_16.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_16.markups.0":{"type":"STRONG","start":29,"end":41,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_17":{"id":"1125c416fdb8_17","name":"3c67","__typename":"Paragraph","type":"IMG","href":null,"layout":"OUTSET_LEFT","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*P_NyzkYXMGipY7Gm9oGl2w.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*P_NyzkYXMGipY7Gm9oGl2w.png":{"id":"1*P_NyzkYXMGipY7Gm9oGl2w.png","originalHeight":271,"originalWidth":364,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_18":{"id":"1125c416fdb8_18","name":"031a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"It appears that users are quite generous in their ratings. The mean rating is 3.58 on a scale of 5. Half the movies have a rating of 4 and 5. I personally think that a 5-level rating skill wasn’t a good indicator as people could have different rating styles (i.e. person A could always use 4 for an average movie, whereas person B only gives 4 out for their favorites). Each user rated at least 20 movies, so I doubt the distribution could be caused just by chance variance in the quality of movies.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_19":{"id":"1125c416fdb8_19","name":"2220","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here’s another word-cloud of the movie genres:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_19.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_19.markups.0":{"type":"STRONG","start":33,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_20":{"id":"1125c416fdb8_20","name":"a9cf","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*Q9zePC_ggd0GB6r67Uw1Bw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*Q9zePC_ggd0GB6r67Uw1Bw.png":{"id":"1*Q9zePC_ggd0GB6r67Uw1Bw.png","originalHeight":397,"originalWidth":956,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_21":{"id":"1125c416fdb8_21","name":"79b0","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The top 5 genres are, in that respect order: Drama, Comedy, Action, Thriller, and Romance.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_22":{"id":"1125c416fdb8_22","name":"a392","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now let’s move on to explore the 4 recommendation systems that can be used. Here they are, in respective order of presentation:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_23":{"id":"1125c416fdb8_23","name":"af70","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Content-Based Filtering","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_24":{"id":"1125c416fdb8_24","name":"61e4","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Memory-Based Collaborative Filtering","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_25":{"id":"1125c416fdb8_25","name":"cf08","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Model-Based Collaborative Filtering","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_26":{"id":"1125c416fdb8_26","name":"5754","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Deep Learning \u002F Neural Network","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_27":{"id":"1125c416fdb8_27","name":"3618","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"1 - Content-Based","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_27.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_27.markups.0":{"type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_28":{"id":"1125c416fdb8_28","name":"1c00","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The Content-Based Recommender relies on the similarity of the items being recommended. The basic idea is that if you like an item, then you will also like a “similar” item. It generally works well when it’s easy to determine the context\u002Fproperties of each item.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_29":{"id":"1125c416fdb8_29","name":"fda8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"A content based recommender works with data that the user provides, either explicitly movie ratings for the MovieLens dataset. Based on that data, a user profile is generated, which is then used to make suggestions to the user. As the user provides more inputs or takes actions on the recommendations, the engine becomes more and more accurate.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_30":{"id":"1125c416fdb8_30","name":"0217","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Math","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_30.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_30.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_31":{"id":"1125c416fdb8_31","name":"19a4","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The concepts of Term Frequency (TF) and Inverse Document Frequency (IDF) are used in information retrieval systems and also content based filtering mechanisms (such as a content based recommender). They are used to determine the relative importance of a document \u002F article \u002F news item \u002F movie etc.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_31.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_31.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_31.markups.0":{"type":"STRONG","start":16,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_31.markups.1":{"type":"STRONG","start":40,"end":72,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_32":{"id":"1125c416fdb8_32","name":"3d1c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"TF is simply the frequency of a word in a document. IDF is the inverse of the document frequency among the whole corpus of documents. TF-IDF is used mainly because of two reasons: Suppose we search for “the results of latest European Socccer games” on Google. It is certain that “the” will occur more frequently than “soccer games” but the relative importance of soccer games is higher than the search query point of view. In such cases, TF-IDF weighting negates the effect of high frequency words in determining the importance of an item (document).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_32.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_32.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_32.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_32.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_32.markups.0":{"type":"STRONG","start":203,"end":247,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_32.markups.1":{"type":"STRONG","start":280,"end":283,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_32.markups.2":{"type":"STRONG","start":318,"end":330,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_32.markups.3":{"type":"STRONG","start":363,"end":375,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_33":{"id":"1125c416fdb8_33","name":"706d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Below is the equation to calculate the TF-IDF score:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_34":{"id":"1125c416fdb8_34","name":"b7e1","__typename":"Paragraph","type":"IMG","href":null,"layout":"OUTSET_LEFT","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*KZrjbKHcsWt-zzUj2oRk3w.jpeg","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*KZrjbKHcsWt-zzUj2oRk3w.jpeg":{"id":"1*KZrjbKHcsWt-zzUj2oRk3w.jpeg","originalHeight":287,"originalWidth":702,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_35":{"id":"1125c416fdb8_35","name":"69b0","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"After calculating TF-IDF scores, how do we determine which items are closer to each other, rather closer to the user profile? This is accomplished using the Vector Space Model which computes the proximity based on the angle between the vectors. In this model, each item is stored as a vector of its attributes (which are also vectors) in an n-dimensional space and the angles between the vectors are calculated to determine the similarity between the vectors. Next, the user profile vectors are also created based on his actions on previous attributes of items and the similarity between an item and a user is also determined in a similar way.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_35.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_35.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_35.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_35.markups.0":{"type":"STRONG","start":157,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_35.markups.1":{"type":"STRONG","start":341,"end":360,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_35.markups.2":{"type":"STRONG","start":414,"end":458,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_36":{"id":"1125c416fdb8_36","name":"2ee6","__typename":"Paragraph","type":"IMG","href":null,"layout":"OUTSET_LEFT","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*b06OA4v3x3yhQiFNNzbzow.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*b06OA4v3x3yhQiFNNzbzow.png":{"id":"1*b06OA4v3x3yhQiFNNzbzow.png","originalHeight":540,"originalWidth":720,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_37":{"id":"1125c416fdb8_37","name":"3d42","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Sentence 2 is more likely to be using Term 2 than using Term 1. Vice-versa for Sentence 1. The method of calculating this relative measure is calculated by taking the cosine of the angle between the sentences and the terms. The ultimate reason behind using cosine is that the value of cosine will increase with decreasing value of the angle between which signifies more similarity. The vectors are length normalized after which they become vectors of length 1 and then the cosine calculation is simply the sum-product of vectors.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_37.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_37.markups.0":{"type":"STRONG","start":276,"end":340,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_38":{"id":"1125c416fdb8_38","name":"76ec","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Code","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_38.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_38.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_39":{"id":"1125c416fdb8_39","name":"6950","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"With all that math in mind, I am going to build a Content-Based Recommendation Engine that computes similarity between movies based on movie genres. It will suggest movies that are most similar to a particular movie based on its genre.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_40":{"id":"1125c416fdb8_40","name":"50b3","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I do not have a quantitative metric to judge the machine’s performance so this will have to be done qualitatively. In order to do so, I’ll use TfidfVectorizer function from scikit-learn, which transforms text to feature vectors that can be used as input to estimator.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_40.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_40.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_40.markups.0":{"type":"STRONG","start":143,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_40.markups.1":{"type":"STRONG","start":173,"end":185,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_41":{"id":"1125c416fdb8_41","name":"ed3c","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from sklearn.feature_extraction.text import TfidfVectorizer\ntf = TfidfVectorizer(analyzer='word',ngram_range=(1, 2),min_df=0, stop_words='english')\ntfidf_matrix = tf.fit_transform(movies['genres'])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_41.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_41.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_41.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_41.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_41.markups.1":{"type":"STRONG","start":5,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_41.markups.2":{"type":"STRONG","start":37,"end":43,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_42":{"id":"1125c416fdb8_42","name":"829a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I will be using the Cosine Similarity to calculate a numeric quantity that denotes the similarity between two movies. Since I have used the TF-IDF Vectorizer, calculating the Dot Product will directly give me the Cosine Similarity Score. Therefore, I will use sklearn’s linear_kernel instead of cosine_similarities since it is much faster.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_42.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_42.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_42.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_42.markups.0":{"type":"A","start":20,"end":37,"href":"https:\u002F\u002Fmasongallo.github.io\u002Fmachine\u002Flearning,\u002Fpython\u002F2016\u002F07\u002F29\u002Fcosine-similarity.html","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_42.markups.1":{"type":"STRONG","start":20,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_42.markups.2":{"type":"STRONG","start":270,"end":283,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_43":{"id":"1125c416fdb8_43","name":"7503","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from sklearn.metrics.pairwise import linear_kernel\ncosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_43.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_43.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_43.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_43.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_43.markups.1":{"type":"STRONG","start":5,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_43.markups.2":{"type":"STRONG","start":30,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_44":{"id":"1125c416fdb8_44","name":"7367","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I now have a pairwise cosine similarity matrix for all the movies in the dataset. The next step is to write a function that returns the 20 most similar movies based on the cosine similarity score.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_45":{"id":"1125c416fdb8_45","name":"4e92","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Build a 1-dimensional array with movie titles\ntitles = movies['title']\nindices = pd.Series(movies.index, index=movies['title'])\n\n# Function that get movie recommendations based on the cosine similarity score of movie genres\ndef genre_recommendations(title):\n    idx = indices[title]\n    sim_scores = list(enumerate(cosine_sim[idx]))\n    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n    sim_scores = sim_scores[1:21]\n    movie_indices = [i[0] for i in sim_scores]\n    return titles.iloc[movie_indices]","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.6","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_45.markups.7","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_45.markups.0":{"type":"STRONG","start":226,"end":229,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_45.markups.1":{"type":"STRONG","start":375,"end":381,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_45.markups.2":{"type":"STRONG","start":399,"end":403,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_45.markups.3":{"type":"STRONG","start":465,"end":468,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_45.markups.4":{"type":"STRONG","start":471,"end":473,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_45.markups.5":{"type":"STRONG","start":490,"end":496,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_45.markups.6":{"type":"EM","start":0,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_45.markups.7":{"type":"EM","start":131,"end":225,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_46":{"id":"1125c416fdb8_46","name":"9b2e","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Recommendation","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_46.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_46.markups.0":{"type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_47":{"id":"1125c416fdb8_47","name":"5084","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s try and get the top recommendations for a few movies and see how good the recommendations are.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_48":{"id":"1125c416fdb8_48","name":"e33b","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"genre_recommendations('Good Will Hunting (1997)').head(20)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_49":{"id":"1125c416fdb8_49","name":"314e","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*zRAvGlrgLCZwqTrmlv30Jw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*zRAvGlrgLCZwqTrmlv30Jw.png":{"id":"1*zRAvGlrgLCZwqTrmlv30Jw.png","originalHeight":700,"originalWidth":960,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_50":{"id":"1125c416fdb8_50","name":"ad2a","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"genre_recommendations('Toy Story (1995)').head(20)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_51":{"id":"1125c416fdb8_51","name":"8b00","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*E3kOkf1lNUg-mlVKtTRofA.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*E3kOkf1lNUg-mlVKtTRofA.png":{"id":"1*E3kOkf1lNUg-mlVKtTRofA.png","originalHeight":700,"originalWidth":972,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_52":{"id":"1125c416fdb8_52","name":"3561","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"genre_recommendations('Saving Private Ryan (1998)').head(20)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_53":{"id":"1125c416fdb8_53","name":"c1c2","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*yUxyA60SFJ3yRaikiM4GBw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*yUxyA60SFJ3yRaikiM4GBw.png":{"id":"1*yUxyA60SFJ3yRaikiM4GBw.png","originalHeight":702,"originalWidth":618,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_54":{"id":"1125c416fdb8_54","name":"2668","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"As you can see, I have quite a decent list of recommendation for Good Will Hunting (Drama), Toy Story (Animation, Children’s, Comedy), and Saving Private Ryan (Action, Thriller, War).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_54.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_54.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_54.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_54.markups.0":{"type":"STRONG","start":65,"end":82,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_54.markups.1":{"type":"STRONG","start":92,"end":101,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_54.markups.2":{"type":"STRONG","start":139,"end":158,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_55":{"id":"1125c416fdb8_55","name":"db8a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Overall, here are the pros of using content-based recommendation:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_56":{"id":"1125c416fdb8_56","name":"d734","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"No need for data on other users, thus no cold-start or sparsity problems.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_57":{"id":"1125c416fdb8_57","name":"02b7","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Can recommend to users with unique tastes.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_58":{"id":"1125c416fdb8_58","name":"06b8","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Can recommend new & unpopular items.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_59":{"id":"1125c416fdb8_59","name":"6ea5","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Can provide explanations for recommended items by listing content-features that caused an item to be recommended (in this case, movie genres)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_60":{"id":"1125c416fdb8_60","name":"94e0","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"However, there are some cons of using this approach:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_61":{"id":"1125c416fdb8_61","name":"5ef6","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Finding the appropriate features is hard.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_62":{"id":"1125c416fdb8_62","name":"17bd","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Does not recommend items outside a user’s content profile.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_63":{"id":"1125c416fdb8_63","name":"c4b0","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"Unable to exploit quality judgments of other users.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_64":{"id":"1125c416fdb8_64","name":"f508","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"2 — Collaborative Filtering","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_64.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_64.markups.0":{"type":"STRONG","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_65":{"id":"1125c416fdb8_65","name":"cac8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The Collaborative Filtering Recommender is entirely based on the past behavior and not on the context. More specifically, it is based on the similarity in preferences, tastes and choices of two users. It analyses how similar the tastes of one user is to another and makes recommendations on the basis of that.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_66":{"id":"1125c416fdb8_66","name":"7b38","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"For instance, if user A likes movies 1, 2, 3 and user B likes movies 2,3,4, then they have similar interests and A should like movie 4 and B should like movie 1. This makes it one of the most commonly used algorithm as it is not dependent on any additional information.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_67":{"id":"1125c416fdb8_67","name":"a68e","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In general, collaborative filtering is the workhorse of recommender engines. The algorithm has a very interesting property of being able to do feature learning on its own, which means that it can start to learn for itself what features to use.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_68":{"id":"1125c416fdb8_68","name":"4948","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Math","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_68.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_68.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_69":{"id":"1125c416fdb8_69","name":"cdac","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"There are 2 main types of memory-based collaborative filtering algorithms:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_70":{"id":"1125c416fdb8_70","name":"caec","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"User-User Collaborative Filtering: Here we find look alike users based on similarity and recommend movies which first user’s look-alike has chosen in past. This algorithm is very effective but takes a lot of time and resources. It requires to compute every user pair information which takes time. Therefore, for big base platforms, this algorithm is hard to implement without a very strong parallelizable system.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_70.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_70.markups.0":{"type":"STRONG","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_71":{"id":"1125c416fdb8_71","name":"fe5d","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Item-Item Collaborative Filtering: It is quite similar to previous algorithm, but instead of finding user’s look-alike, we try finding movie’s look-alike. Once we have movie’s look-alike matrix, we can easily recommend alike movies to user who have rated any movie from the dataset. This algorithm is far less resource consuming than user-user collaborative filtering. Hence, for a new user, the algorithm takes far lesser time than user-user collaborate as we don’t need all similarity scores between users. And with fixed number of movies, movie-movie look alike matrix is fixed over time.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_71.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_71.markups.0":{"type":"STRONG","start":0,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_72":{"id":"1125c416fdb8_72","name":"9c5b","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*QvhetbRjCr1vryTch_2HZQ.jpeg","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*QvhetbRjCr1vryTch_2HZQ.jpeg":{"id":"1*QvhetbRjCr1vryTch_2HZQ.jpeg","originalHeight":540,"originalWidth":960,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_73":{"id":"1125c416fdb8_73","name":"345f","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In either scenario, we builds a similarity matrix. For user-user collaborative filtering, the user-similarity matrix will consist of some distance metrics that measure the similarity between any two pairs of users. Likewise, the item-similarity matrix will measure the similarity between any two pairs of items.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_73.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_73.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_73.markups.0":{"type":"STRONG","start":94,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_73.markups.1":{"type":"STRONG","start":229,"end":251,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_74":{"id":"1125c416fdb8_74","name":"1d53","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"There are 3 distance similarity metrics that are usually used in collaborative filtering:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_75":{"id":"1125c416fdb8_75","name":"5175","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Jaccard Similarity: Similarity is based on the number of users which have rated item A and B divided by the number of users who have rated either A or B. It is typically used where we don’t have a numeric rating but just a boolean value like a product being bought or an add being clicked.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_75.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_75.markups.0":{"type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_76":{"id":"1125c416fdb8_76","name":"ff2a","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Cosine Similarity: (as in the Content-Based system) Similarity is the cosine of the angle between the 2 vectors of the item vectors of A and B. Closer the vectors, smaller will be the angle and larger the cosine.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_76.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_76.markups.0":{"type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_77":{"id":"1125c416fdb8_77","name":"e790","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Pearson Similarity: Similarity is the pearson coefficient between the two vectors. For the purpose of diversity, I will use Pearson Similarity in this implementation.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_77.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_77.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_77.markups.0":{"type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_77.markups.1":{"type":"STRONG","start":124,"end":142,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_78":{"id":"1125c416fdb8_78","name":"3e27","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Code","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_78.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_78.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_79":{"id":"1125c416fdb8_79","name":"d389","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Due to the limited computing power in my laptop, I will build the recommender system using only a subset of the ratings. In particular, I will take a random sample of 20,000 ratings (2%) from the 1M ratings.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_80":{"id":"1125c416fdb8_80","name":"91b0","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I use the scikit-learn library to split the dataset into testing and training. Cross_validation.train_test_split shuffles and splits the data into two datasets according to the percentage of test examples, which in this case is 0.2.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_80.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_80.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_80.markups.0":{"type":"STRONG","start":10,"end":30,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_80.markups.1":{"type":"STRONG","start":79,"end":112,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_81":{"id":"1125c416fdb8_81","name":"4e20","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from sklearn import cross_validation as cv\ntrain_data, test_data = cv.train_test_split(small_data, test_size=0.2)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_81.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_81.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_81.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_81.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_81.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_81.markups.1":{"type":"STRONG","start":5,"end":12,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_81.markups.2":{"type":"STRONG","start":13,"end":19,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_81.markups.3":{"type":"STRONG","start":37,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_82":{"id":"1125c416fdb8_82","name":"3b05","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now I need to create a user-item matrix. Since I have splitted the data into testing and training, I need to create two matrices. The training matrix contains 80% of the ratings and the testing matrix contains 20% of the ratings.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_83":{"id":"1125c416fdb8_83","name":"05c5","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Create two user-item matrices, one for training and another for testing\ntrain_data_matrix = train_data.as_matrix(columns = ['user_id', 'movie_id', 'rating'])\ntest_data_matrix = test_data.as_matrix(columns = ['user_id', 'movie_id', 'rating'])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_83.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_83.markups.0":{"type":"EM","start":0,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_84":{"id":"1125c416fdb8_84","name":"de98","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now I use the pairwise_distances function from sklearn to calculate the Pearson Correlation Coefficient. This method provides a safe way to take a distance matrix as input, while preserving compatibility with many other algorithms that take a vector array.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_84.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_84.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_84.markups.0":{"type":"A","start":72,"end":103,"href":"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F1838806\u002Feuclidean-distance-vs-pearson-correlation-vs-cosine-similarity","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_84.markups.1":{"type":"STRONG","start":14,"end":32,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_85":{"id":"1125c416fdb8_85","name":"804a","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from sklearn.metrics.pairwise import pairwise_distances\n\n# User Similarity Matrix\nuser_correlation = 1 - pairwise_distances(train_data, metric='correlation')\nuser_correlation[np.isnan(user_correlation)] = 0","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_85.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_85.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_85.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_85.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_85.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_85.markups.1":{"type":"STRONG","start":5,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_85.markups.2":{"type":"STRONG","start":30,"end":36,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_85.markups.3":{"type":"EM","start":57,"end":81,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_86":{"id":"1125c416fdb8_86","name":"aab7","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Item Similarity Matrix\nitem_correlation = 1 - pairwise_distances(train_data_matrix.T, metric='correlation')\nitem_correlation[np.isnan(item_correlation)] = 0","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_86.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_86.markups.0":{"type":"EM","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_87":{"id":"1125c416fdb8_87","name":"f486","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"With the similarity matrix in hand, I can now predict the ratings that were not included with the data. Using these predictions, I can then compare them with the test data to attempt to validate the quality of our recommender model.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_88":{"id":"1125c416fdb8_88","name":"24e9","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Function to predict ratings\ndef predict(ratings, similarity, type='user'):\n    if type == 'user':\n        mean_user_rating = ratings.mean(axis=1)\n        # Use np.newaxis so that mean_user_rating has same format as ratings\n        ratings_diff = (ratings - mean_user_rating[:, np.newaxis])\n        pred = mean_user_rating[:, np.newaxis] + similarity.dot(ratings_diff) \u002F np.array([np.abs(similarity).sum(axis=1)]).T\n    elif type == 'item':\n        pred = ratings.dot(similarity) \u002F np.array([np.abs(similarity).sum(axis=1)])\n    return pred","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_88.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_88.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_88.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_88.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_88.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_88.markups.5","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_88.markups.0":{"type":"STRONG","start":30,"end":33,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_88.markups.1":{"type":"STRONG","start":81,"end":83,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_88.markups.2":{"type":"STRONG","start":421,"end":425,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_88.markups.3":{"type":"STRONG","start":530,"end":536,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_88.markups.4":{"type":"EM","start":0,"end":29,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_88.markups.5":{"type":"EM","start":156,"end":224,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_89":{"id":"1125c416fdb8_89","name":"8ebb","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Evaluation","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_89.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_89.markups.0":{"type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_90":{"id":"1125c416fdb8_90","name":"5160","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"There are many evaluation metrics but one of the most popular metric used to evaluate accuracy of predicted ratings is Root Mean Squared Error (RMSE). I will use the mean_square_error (MSE) function from sklearn, where the RMSE is just the square root of MSE. I’ll use the scikit-learn’s mean squared error function as my validation metric. Comparing user- and item-based collaborative filtering, it looks like user-based collaborative filtering gives a better result.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_90.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_90.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_90.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_90.markups.0":{"type":"STRONG","start":119,"end":149,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_90.markups.1":{"type":"STRONG","start":166,"end":189,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_90.markups.2":{"type":"STRONG","start":288,"end":306,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91":{"id":"1125c416fdb8_91","name":"2823","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from sklearn.metrics import mean_squared_error\nfrom math import sqrt\n\n# Function to calculate RMSE\ndef rmse(pred, actual):\n    # Ignore nonzero terms.\n    pred = pred[actual.nonzero()].flatten()\n    actual = actual[actual.nonzero()].flatten()\n    return sqrt(mean_squared_error(pred, actual))","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.6","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.7","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.8","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_91.markups.9","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_91.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.1":{"type":"STRONG","start":5,"end":20,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.2":{"type":"STRONG","start":21,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.3":{"type":"STRONG","start":47,"end":51,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.4":{"type":"STRONG","start":52,"end":56,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.5":{"type":"STRONG","start":57,"end":63,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.6":{"type":"STRONG","start":99,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.7":{"type":"STRONG","start":247,"end":253,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.8":{"type":"EM","start":70,"end":98,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_91.markups.9":{"type":"EM","start":127,"end":150,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_92":{"id":"1125c416fdb8_92","name":"2e38","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Predict ratings on the training data with both similarity score\nuser_prediction = predict(train_data_matrix, user_correlation, type='user')\nitem_prediction = predict(train_data_matrix, item_correlation, type='item')","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_92.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_92.markups.0":{"type":"EM","start":0,"end":65,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_93":{"id":"1125c416fdb8_93","name":"6af4","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# RMSE on the train data\nprint('User-based CF RMSE: ' + str(rmse(user_prediction, train_data_matrix)))\nprint('Item-based CF RMSE: ' + str(rmse(item_prediction, train_data_matrix)))","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_93.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_93.markups.0":{"type":"EM","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_94":{"id":"1125c416fdb8_94","name":"7bb5","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"## Output\nUser-based CF RMSE: 699.9584792778463\nItem-based CF RMSE: 114.97271725933925","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_95":{"id":"1125c416fdb8_95","name":"c005","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"RMSE of training of model is a metric which measure how much the signal and the noise is explained by the model. I noticed that my RMSE is quite big. I suppose I might have overfitted the training data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_96":{"id":"1125c416fdb8_96","name":"9cbc","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Overall, Memory-based Collaborative Filtering is easy to implement and produce reasonable prediction quality. However, there are some drawback of this approach:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_96.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_96.markups.0":{"type":"STRONG","start":9,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_97":{"id":"1125c416fdb8_97","name":"bcb4","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It doesn’t address the well-known cold-start problem, that is when new user or new item enters the system.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_98":{"id":"1125c416fdb8_98","name":"a4f2","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It can’t deal with sparse data, meaning it’s hard to find users that have rated the same items.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_99":{"id":"1125c416fdb8_99","name":"4c72","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It suffers when new users or items that don’t have any ratings enter the system.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_100":{"id":"1125c416fdb8_100","name":"ab9a","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"It tends to recommend popular items.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_101":{"id":"1125c416fdb8_101","name":"98dd","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: The complete code for content-based and memory-based collaborative filtering can be found in this Jupyter Notebook.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_101.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_101.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_101.markups.0":{"type":"A","start":99,"end":120,"href":"https:\u002F\u002Fgithub.com\u002Fkhanhnamle1994\u002Fmovielens\u002Fblob\u002Fmaster\u002FContent_Based_and_Collaborative_Filtering_Models.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_101.markups.1":{"type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_102":{"id":"1125c416fdb8_102","name":"0a37","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*PfgYi6hg02TDM0GknVa2nQ.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*PfgYi6hg02TDM0GknVa2nQ.png":{"id":"1*PfgYi6hg02TDM0GknVa2nQ.png","originalHeight":597,"originalWidth":975,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_103":{"id":"1125c416fdb8_103","name":"7acf","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"3 — Matrix Factorization","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_103.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_103.markups.0":{"type":"STRONG","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_104":{"id":"1125c416fdb8_104","name":"f60d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"In the previous attempt, I have used memory-based collaborative filtering to make movie recommendations from users’ ratings data. I can only try them on a very small data sample (20,000 ratings), and ended up getting pretty high Root Mean Squared Error (bad recommendations). Memory-based collaborative filtering approaches that compute distance relationships between items or users have these two major issues:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_105":{"id":"1125c416fdb8_105","name":"d4f6","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"It doesn’t scale particularly well to massive datasets, especially for real-time recommendations based on user behavior similarities — which takes a lot of computations.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_106":{"id":"1125c416fdb8_106","name":"4612","__typename":"Paragraph","type":"OLI","href":null,"layout":null,"metadata":null,"text":"Ratings matrices may be overfitting to noisy representations of user tastes and preferences. When we use distance based “neighborhood” approaches on raw data, we match to sparse low-level details that we assume represent the user’s preference vector instead of the vector itself.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_107":{"id":"1125c416fdb8_107","name":"e215","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*bWAAyciKq580ArTix_O3nw.jpeg","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*bWAAyciKq580ArTix_O3nw.jpeg":{"id":"1*bWAAyciKq580ArTix_O3nw.jpeg","originalHeight":479,"originalWidth":638,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_108":{"id":"1125c416fdb8_108","name":"4076","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Thus I’d need to apply Dimensionality Reduction technique to derive the tastes and preferences from the raw data, otherwise known as doing low-rank matrix factorization. Why reduce dimensions?","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_108.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_108.markups.0":{"type":"STRONG","start":23,"end":47,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_109":{"id":"1125c416fdb8_109","name":"ddae","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"I can discover hidden correlations \u002F features in the raw data.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_110":{"id":"1125c416fdb8_110","name":"ac91","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"I can remove redundant and noisy features that are not useful.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_111":{"id":"1125c416fdb8_111","name":"a858","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"I can interpret and visualize the data easier.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_112":{"id":"1125c416fdb8_112","name":"ccb3","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"I can also access easier data storage and processing.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_113":{"id":"1125c416fdb8_113","name":"1076","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Math","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_113.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_113.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_114":{"id":"1125c416fdb8_114","name":"8b1a","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Model-based Collaborative Filtering is based on matrix factorization (MF) which has received greater exposure, mainly as an unsupervised learning method for latent variable decomposition and dimensionality reduction. Matrix factorization is widely used for recommender systems where it can deal better with scalability and sparsity than Memory-based CF:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_114.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_114.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_114.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_114.markups.3","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_114.markups.0":{"type":"STRONG","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_114.markups.1":{"type":"STRONG","start":48,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_114.markups.2":{"type":"EM","start":0,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_114.markups.3":{"type":"EM","start":48,"end":73,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_115":{"id":"1125c416fdb8_115","name":"791b","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The goal of MF is to learn the latent preferences of users and the latent attributes of items from known ratings (learn features that describe the characteristics of ratings) to then predict the unknown ratings through the dot product of the latent features of users and items.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_116":{"id":"1125c416fdb8_116","name":"42e8","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"When you have a very sparse matrix, with a lot of dimensions, by doing matrix factorization, you can restructure the user-item matrix into low-rank structure, and you can represent the matrix by the multiplication of two low-rank matrices, where the rows contain the latent vector.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_117":{"id":"1125c416fdb8_117","name":"1aaa","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"You fit this matrix to approximate your original matrix, as closely as possible, by multiplying the low-rank matrices together, which fills in the entries missing in the original matrix.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_118":{"id":"1125c416fdb8_118","name":"20c0","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"A well-known matrix factorization method is Singular value decomposition (SVD). At a high level, SVD is an algorithm that decomposes a matrix A into the best lower rank (i.e. smaller\u002Fsimpler) approximation of the original matrix A. Mathematically, it decomposes A into a two unitary matrices and a diagonal matrix:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_118.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_118.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_118.markups.0":{"type":"STRONG","start":44,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_118.markups.1":{"type":"EM","start":44,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_119":{"id":"1125c416fdb8_119","name":"95f6","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*W4MnB2hyvgqedLmwJLrpqw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*W4MnB2hyvgqedLmwJLrpqw.png":{"id":"1*W4MnB2hyvgqedLmwJLrpqw.png","originalHeight":1421,"originalWidth":2543,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_120":{"id":"1125c416fdb8_120","name":"26bd","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"where A is the input data matrix (users’s ratings), U is the left singular vectors (user “features” matrix), Sum is the diagonal matrix of singular values (essentially weights\u002Fstrengths of each concept), and V^T is the right singular vectors (movie “features” matrix). U and V^T are column orthonormal, and represent different things: U represents how much users “like” each feature and V^T represents how relevant each feature is to each movie.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_121":{"id":"1125c416fdb8_121","name":"82b5","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"To get the lower rank approximation, I take these matrices and keep only the top k features, which can be thought of as the underlying tastes and preferences vectors.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_122":{"id":"1125c416fdb8_122","name":"dc02","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The Code","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_122.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_122.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_123":{"id":"1125c416fdb8_123","name":"ad23","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Scipy and Numpy both have functions to do the singular value decomposition. I’m going to use the Scipy function svds because it let’s me choose how many latent factors I want to use to approximate the original ratings matrix (instead of having to truncate it after).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_123.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_123.markups.0":{"type":"EM","start":112,"end":116,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_124":{"id":"1125c416fdb8_124","name":"42ae","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"from scipy.sparse.linalg import svds \nU, sigma, Vt = svds(Ratings_demeaned, k = 50)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_124.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_124.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_124.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_124.markups.0":{"type":"STRONG","start":0,"end":4,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_124.markups.1":{"type":"STRONG","start":5,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_124.markups.2":{"type":"STRONG","start":25,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_125":{"id":"1125c416fdb8_125","name":"7a4b","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"As I’m going to leverage matrix multiplication to get predictions, I’ll convert the Sum (now are values) to the diagonal matrix form.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_126":{"id":"1125c416fdb8_126","name":"adcd","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sigma = np.diag(sigma)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_127":{"id":"1125c416fdb8_127","name":"698c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I now have everything I need to make movie ratings predictions for every user. I can do it all at once by following the math and matrix multiply U, Sum, and V^T back to get the rank k = 50 approximation of A.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_128":{"id":"1125c416fdb8_128","name":"d0fc","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"But first, I need to add the user means back to get the actual star ratings prediction.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_129":{"id":"1125c416fdb8_129","name":"d757","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"all_user_predicted_ratings = np.dot(np.dot(U, sigma), Vt) + user_ratings_mean.reshape(-1, 1)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_130":{"id":"1125c416fdb8_130","name":"b80c","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"With the predictions matrix for every user, I can build a function to recommend movies for any user. I return the list of movies the user has already rated, for the sake of comparison.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_131":{"id":"1125c416fdb8_131","name":"d942","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"preds = pd.DataFrame(all_user_predicted_ratings, columns = Ratings.columns)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_132":{"id":"1125c416fdb8_132","name":"999f","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now I write a function to return the movies with the highest predicted rating that the specified user hasn’t already rated.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_133":{"id":"1125c416fdb8_133","name":"e5dd","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def recommend_movies(predictions, userID, movies, original_ratings, num_recommendations):\n    \n    # Get and sort the user's predictions\n    user_row_number = userID - 1 # User ID starts at 1, not 0\n    sorted_user_predictions = preds.iloc[user_row_number].sort_values(ascending=False) # User ID starts at 1\n    \n    # Get the user's data and merge in the movie information.\n    user_data = original_ratings[original_ratings.user_id == (userID)]\n    user_full = (user_data.merge(movies, how = 'left', left_on = 'movie_id', right_on = 'movie_id').\n                     sort_values(['rating'], ascending=False)\n                 )\n    \n    # Recommend the highest predicted rating movies that the user hasn't seen yet.\n    recommendations = (movies[~movies['movie_id'].isin(user_full['movie_id'])].\n         merge(pd.DataFrame(sorted_user_predictions).reset_index(), how = 'left',\n               left_on = 'movie_id',\n               right_on = 'movie_id').\n         rename(columns = {user_row_number: 'Predictions'}).\n         sort_values('Predictions', ascending = False).\n                       iloc[:num_recommendations, :-1]\n                      )\n\n    return user_full, recommendations","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_133.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_133.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_133.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_133.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_133.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_133.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_133.markups.6","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_133.markups.0":{"type":"STRONG","start":0,"end":3,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_133.markups.1":{"type":"STRONG","start":1155,"end":1161,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_133.markups.2":{"type":"EM","start":99,"end":136,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_133.markups.3":{"type":"EM","start":170,"end":198,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_133.markups.4":{"type":"EM","start":286,"end":307,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_133.markups.5":{"type":"EM","start":317,"end":374,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_133.markups.6":{"type":"EM","start":637,"end":715,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_134":{"id":"1125c416fdb8_134","name":"164f","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Evaluation","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_134.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_134.markups.0":{"type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_135":{"id":"1125c416fdb8_135","name":"046d","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Instead of doing evaluation manually like the last time, I will use the Surprise library that provided various ready-to-use powerful prediction algorithms including (SVD) to evaluate its RMSE (Root Mean Squared Error) on the MovieLens dataset. It is a Python scikit building and analyzing recommender systems.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_135.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_135.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_135.markups.0":{"type":"A","start":72,"end":80,"href":"https:\u002F\u002Fpypi.python.org\u002Fpypi\u002Fscikit-surprise","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_135.markups.1":{"type":"EM","start":72,"end":80,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_136":{"id":"1125c416fdb8_136","name":"9be1","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Import libraries from Surprise package\nfrom surprise import Reader, Dataset, SVD, evaluate\n\n# Load Reader library\nreader = Reader()\n\n# Load ratings dataset with Dataset library\ndata = Dataset.load_from_df(ratings[['user_id', 'movie_id', 'rating']], reader)\n\n# Split the dataset for 5-fold evaluation\ndata.split(n_folds=5)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_136.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_136.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_136.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_136.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_136.markups.4","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_136.markups.5","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_136.markups.6","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_136.markups.0":{"type":"STRONG","start":41,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_136.markups.1":{"type":"STRONG","start":46,"end":54,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_136.markups.2":{"type":"STRONG","start":55,"end":61,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_136.markups.3":{"type":"EM","start":0,"end":40,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_136.markups.4":{"type":"EM","start":94,"end":115,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_136.markups.5":{"type":"EM","start":135,"end":178,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_136.markups.6":{"type":"EM","start":260,"end":301,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_137":{"id":"1125c416fdb8_137","name":"b8f6","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Use the SVD algorithm.\nsvd = SVD()\n\n# Compute the RMSE of the SVD algorithm.\nevaluate(svd, data, measures=['RMSE'])","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_137.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_137.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_137.markups.0":{"type":"EM","start":0,"end":24,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_137.markups.1":{"type":"EM","start":38,"end":78,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_138":{"id":"1125c416fdb8_138","name":"ca72","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I get a mean Root Mean Square Error of 0.8736 which is pretty good.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_138.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_138.markups.0":{"type":"EM","start":13,"end":35,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_139":{"id":"1125c416fdb8_139","name":"82e2","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Recommendation","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_139.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_139.markups.0":{"type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_140":{"id":"1125c416fdb8_140","name":"33e1","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s try to recommend 20 movies for user with ID 1310.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_141":{"id":"1125c416fdb8_141","name":"433f","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"predictions = recommend_movies(preds, 1310, movies, ratings, 20)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_142":{"id":"1125c416fdb8_142","name":"15ae","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"predictions","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_143":{"id":"1125c416fdb8_143","name":"5709","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*1NNP0ayB8_HbMChzoYv-pw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*1NNP0ayB8_HbMChzoYv-pw.png":{"id":"1*1NNP0ayB8_HbMChzoYv-pw.png","originalHeight":1222,"originalWidth":1344,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_144":{"id":"1125c416fdb8_144","name":"83ee","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"These look like pretty good recommendations. It’s good to see that, although I didn’t actually use the genre of the movie as a feature, the truncated matrix factorization features “picked up” on the underlying tastes and preferences of the user. I’ve recommended some comedy, drama, and romance movies — all of which were genres of some of this user’s top rated movies.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_145":{"id":"1125c416fdb8_145","name":"87b8","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: The complete code for SVD Matrix Factorization can be found in this Jupyter Notebook.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_145.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_145.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_145.markups.0":{"type":"A","start":69,"end":90,"href":"https:\u002F\u002Fgithub.com\u002Fkhanhnamle1994\u002Fmovielens\u002Fblob\u002Fmaster\u002FSVD_Model.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_145.markups.1":{"type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_146":{"id":"1125c416fdb8_146","name":"a7b9","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"4 — Deep Learning","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_146.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_146.markups.0":{"type":"STRONG","start":0,"end":17,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_147":{"id":"1125c416fdb8_147","name":"2fa9","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Math","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_147.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_147.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_148":{"id":"1125c416fdb8_148","name":"a852","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The idea of using deep learning is similar to that of Model-Based Matrix Factorization. In matrix factorization, we decompose our original sparse matrix into product of 2 low rank orthogonal matrices. For deep learning implementation, we don’t need them to be orthogonal, we want our model to learn the values of embedding matrix itself. The user latent features and movie latent features are looked up from the embedding matrices for specific movie-user combination. These are the input values for further linear and non-linear layers. We can pass this input to multiple relu, linear or sigmoid layers and learn the corresponding weights by any optimization algorithm (Adam, SGD, etc.).","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_149":{"id":"1125c416fdb8_149","name":"fd55","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Code","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_149.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_149.markups.0":{"type":"STRONG","start":0,"end":8,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_150":{"id":"1125c416fdb8_150","name":"6656","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here are the main components of my neural network:","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_151":{"id":"1125c416fdb8_151","name":"8353","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*OK0qufUIpzzJO1Ofqy5cqw.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*OK0qufUIpzzJO1Ofqy5cqw.png":{"id":"1*OK0qufUIpzzJO1Ofqy5cqw.png","originalHeight":255,"originalWidth":651,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_152":{"id":"1125c416fdb8_152","name":"0125","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A left embedding layer that creates a Users by Latent Factors matrix.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_153":{"id":"1125c416fdb8_153","name":"ca81","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A right embedding layer that creates a Movies by Latent Factors matrix.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_154":{"id":"1125c416fdb8_154","name":"da58","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"When the input to these layers are (i) a user id and (ii) a movie id, they’ll return the latent factor vectors for the user and the movie, respectively.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_155":{"id":"1125c416fdb8_155","name":"4b9e","__typename":"Paragraph","type":"ULI","href":null,"layout":null,"metadata":null,"text":"A merge layer that takes the dot product of these two latent vectors to return the predicted rating.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_156":{"id":"1125c416fdb8_156","name":"3c46","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"This code is based on the approach outlined in Alkahest’s blog post Collaborative Filtering in Keras.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_156.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_156.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_156.markups.0":{"type":"A","start":47,"end":55,"href":"http:\u002F\u002Fwww.fenris.org\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_156.markups.1":{"type":"A","start":68,"end":100,"href":"http:\u002F\u002Fwww.fenris.org\u002F2016\u002F03\u002F07\u002Findex-html","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_157":{"id":"1125c416fdb8_157","name":"0d6f","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"I then compile the model using Mean Squared Error (MSE) as the loss function and the AdaMax learning algorithm.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_158":{"id":"1125c416fdb8_158","name":"29bd","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Define model\nmodel = CFModel(max_userid, max_movieid, K_FACTORS)\n# Compile the model using MSE as the loss function and the AdaMax learning algorithm\nmodel.compile(loss='mse', optimizer='adamax')","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_158.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_158.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_158.markups.0":{"type":"EM","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_158.markups.1":{"type":"EM","start":67,"end":151,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_159":{"id":"1125c416fdb8_159","name":"2352","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Now I need to train the model. This step will be the most-time consuming one. In my particular case, for our dataset with nearly 1 million ratings, almost 6,000 users and 4,000 movies, I trained the model in roughly 6 minutes per epoch (30 epochs ~ 3 hours) inside my Macbook Laptop CPU. I spitted the training and validataion data with ratio of 90\u002F10.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_160":{"id":"1125c416fdb8_160","name":"8a1d","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Callbacks monitor the validation loss\n# Save the model weights each time the validation loss has improved\ncallbacks = [EarlyStopping('val_loss', patience=2), \n             ModelCheckpoint('weights.h5', save_best_only=True)]\n\n# Use 30 epochs, 90% training data, 10% validation data \nhistory = model.fit([Users, Movies], Ratings, nb_epoch=30, validation_split=.1, verbose=2, callbacks=callbacks)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_160.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_160.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_160.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_160.markups.0":{"type":"EM","start":0,"end":39,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_160.markups.1":{"type":"EM","start":40,"end":107,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_160.markups.2":{"type":"EM","start":227,"end":283,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_161":{"id":"1125c416fdb8_161","name":"3ac5","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The next step is to actually predict the ratings a random user will give to a random movie. Below I apply the freshly trained deep learning model for all the users and all the movies, using 100 dimensional embeddings for each of them.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_162":{"id":"1125c416fdb8_162","name":"cfd1","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Use the pre-trained model\ntrained_model = CFModel(max_userid, max_movieid, K_FACTORS)\n# Load weights\ntrained_model.load_weights('weights.h5')","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_162.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_162.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_162.markups.0":{"type":"EM","start":0,"end":27,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_162.markups.1":{"type":"EM","start":88,"end":102,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_163":{"id":"1125c416fdb8_163","name":"08c6","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here I define the function to predict user’s rating of unrated items.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_164":{"id":"1125c416fdb8_164","name":"bb2e","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Function to predict the ratings given User ID and Movie ID\ndef predict_rating(user_id, movie_id):\n    return trained_model.rate(user_id - 1, movie_id - 1)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_164.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_164.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_164.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_164.markups.0":{"type":"STRONG","start":61,"end":64,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_164.markups.1":{"type":"STRONG","start":104,"end":110,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_164.markups.2":{"type":"EM","start":0,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_165":{"id":"1125c416fdb8_165","name":"104e","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Evaluation","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_165.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_165.markups.0":{"type":"STRONG","start":0,"end":14,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_166":{"id":"1125c416fdb8_166","name":"36c0","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"During the training process above, I saved the model weights each time the validation loss has improved. Thus, I can use that value to calculate the best validation Root Mean Square Error.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_167":{"id":"1125c416fdb8_167","name":"0942","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"# Show the best validation RMSE\nmin_val_loss, idx = min((val, idx) for (idx, val) in enumerate(history.history['val_loss']))","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_167.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_167.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_167.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_167.markups.0":{"type":"STRONG","start":67,"end":70,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_167.markups.1":{"type":"STRONG","start":82,"end":84,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_167.markups.2":{"type":"EM","start":0,"end":31,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_168":{"id":"1125c416fdb8_168","name":"dc38","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"print 'Minimum RMSE at epoch', '{:d}'.format(idx+1), '=', '{:.4f}'.format(math.sqrt(min_val_loss))","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_168.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_168.markups.0":{"type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_169":{"id":"1125c416fdb8_169","name":"b848","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"## Output\nMinimum RMSE at epoch 17 = 0.8616","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_170":{"id":"1125c416fdb8_170","name":"e947","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"The best validation loss is 0.7424 at epoch 17. Taking the square root of that number, I got the RMSE value of 0.8616, which is better than the RMSE from the SVD Model (0.8736).","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_170.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_170.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_170.markups.2","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_170.markups.0":{"type":"EM","start":28,"end":34,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_170.markups.1":{"type":"EM","start":111,"end":117,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_170.markups.2":{"type":"EM","start":169,"end":175,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_171":{"id":"1125c416fdb8_171","name":"0c63","__typename":"Paragraph","type":"H4","href":null,"layout":null,"metadata":null,"text":"The Recommendation","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_171.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_171.markups.0":{"type":"STRONG","start":0,"end":18,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_172":{"id":"1125c416fdb8_172","name":"460e","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Here I make a recommendation list of unrated 20 movies sorted by prediction value for user ID 2000. Let’s see it.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_173":{"id":"1125c416fdb8_173","name":"8ab0","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"recommendations = ratings[ratings['movie_id'].isin(user_ratings['movie_id']) == False][['movie_id']].drop_duplicates()","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_174":{"id":"1125c416fdb8_174","name":"9bbf","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"recommendations['prediction'] = recommendations.apply(lambda x: predict_rating(TEST_USER, x['movie_id']), axis=1)","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_174.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_174.markups.0":{"type":"STRONG","start":54,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_175":{"id":"1125c416fdb8_175","name":"abc1","__typename":"Paragraph","type":"PRE","href":null,"layout":null,"metadata":null,"text":"recommendations.sort_values(by='prediction', ascending=False).merge(movies, on='movie_id', how='inner',\nsuffixes=['_u', '_m']).head(20)","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_176":{"id":"1125c416fdb8_176","name":"a721","__typename":"Paragraph","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:1*TV-g8yLa1JhIr6c9ILUDpA.png","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*TV-g8yLa1JhIr6c9ILUDpA.png":{"id":"1*TV-g8yLa1JhIr6c9ILUDpA.png","originalHeight":1224,"originalWidth":1246,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:1125c416fdb8_177":{"id":"1125c416fdb8_177","name":"edec","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"This model performed better than all the approaches I attempted before (content-based, user-item similarity collaborative filtering, SVD). I can certainly improve this model’s performance by making it deeper with more linear and non-linear layers.","hasDropCap":null,"dropCapImage":null,"markups":[],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_178":{"id":"1125c416fdb8_178","name":"7938","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Note: The complete code for Deep Learning Model can be found in this Jupyter Notebook.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_178.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_178.markups.1","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_178.markups.0":{"type":"A","start":64,"end":85,"href":"https:\u002F\u002Fgithub.com\u002Fkhanhnamle1994\u002Fmovielens\u002Fblob\u002Fmaster\u002FDeep_Learning_Model.ipynb","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_178.markups.1":{"type":"STRONG","start":0,"end":5,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_179":{"id":"1125c416fdb8_179","name":"eb85","__typename":"Paragraph","type":"H3","href":null,"layout":null,"metadata":null,"text":"Last Takeaway","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_179.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_179.markups.0":{"type":"STRONG","start":0,"end":13,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:1125c416fdb8_180":{"id":"1125c416fdb8_180","name":"0694","__typename":"Paragraph","type":"P","href":null,"layout":null,"metadata":null,"text":"Recommendation Engine is your companion and advisor to help you make the right choices by providing you tailored options and creating a personalized experience for you. It is beyond any doubt that recommendation engines are getting popular and critical in the new age of things. It is going to be in your best interest to learn to use them for businesses to be more competitive and consumers to be more efficient. I hope that this post has been helpful for you to learn about the 4 different approaches to build your own movie recommendation system. You can view all the source code in my GitHub repo at this link (https:\u002F\u002Fgithub.com\u002Fkhanhnamle1994\u002Fmovielens). Let me know if you have any questions or suggestions on improvement!","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:1125c416fdb8_180.markups.0","typename":"Markup"}],"iframe":null,"mixtapeMetadata":null},"Paragraph:1125c416fdb8_180.markups.0":{"type":"A","start":615,"end":658,"href":"https:\u002F\u002Fgithub.com\u002Fkhanhnamle1994\u002Fmovielens","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Tag:recommendation-system":{"id":"recommendation-system","displayTitle":"Recommendation System","__typename":"Tag"},"Tag:movies":{"id":"movies","displayTitle":"Movies","__typename":"Tag"},"Tag:machine-learning":{"id":"machine-learning","displayTitle":"Machine Learning","__typename":"Tag"},"Tag:personalization":{"id":"personalization","displayTitle":"Personalization","__typename":"Tag"},"Tag:predictions":{"id":"predictions","displayTitle":"Predictions","__typename":"Tag"},"$Post:bbec857b8223.previewContent":{"subtitle":"“What movie should I watch this evening?”","__typename":"PreviewContent"},"data-science":{"name":"Data Science","slug":"data-science","__typename":"Topic"},"$ROOT_QUERY.notificationsConnection({}).notifications.0":{"notificationType":"quote","occurredAt":1570076913451,"isUnread":false,"post":{"type":"id","generated":false,"id":"Post:f516101c24cf","typename":"Post"},"actor":{"type":"id","generated":false,"id":"User:bfdc06ac76","typename":"User"},"quote":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).notifications.0.quote","typename":"Quote"},"rollupItems":[],"__typename":"Notification","responsePost":null,"collection":null,"note":null,"noteReply":null,"milestoneArg":0},"Post:f516101c24cf":{"id":"f516101c24cf","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@saicharanars\u002Fbuilding-vgg19-with-keras-f516101c24cf","title":"Building VGG19 with Keras","visibility":"PUBLIC","__typename":"Post"},"User:bfdc06ac76":{"id":"bfdc06ac76","name":"abhay jain","__typename":"User","username":"abhayjain1796","imageId":"0*KGz_GdYf3b32RwLu.jpg","mediumMemberAt":0},"$ROOT_QUERY.notificationsConnection({}).notifications.0.quote":{"startOffset":279,"endOffset":334,"quoteParagraphPreview":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).notifications.0.quote.quoteParagraphPreview","typename":"Paragraph"},"paragraphs":[{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).notifications.0.quote.paragraphs.0","typename":"Paragraph"}],"__typename":"Quote"},"$ROOT_QUERY.notificationsConnection({}).notifications.0.quote.quoteParagraphPreview":{"text":"… of which stand out are their GPU and RAM). One of those models that we will discuss here is VGG19. VGG19 can classify your image in 1000 possible classes.","__typename":"Paragraph"},"$ROOT_QUERY.notificationsConnection({}).notifications.0.quote.paragraphs.0":{"type":"P","__typename":"Paragraph"},"$ROOT_QUERY.notificationsConnection({}).notifications.1":{"notificationType":"users_following_you","occurredAt":1565791760331,"isUnread":false,"post":null,"actor":{"type":"id","generated":false,"id":"User:9ec97de55fb7","typename":"User"},"quote":null,"rollupItems":[],"__typename":"Notification","responsePost":null,"collection":null,"note":null,"noteReply":null,"milestoneArg":0},"User:9ec97de55fb7":{"id":"9ec97de55fb7","name":"Venkat Chadalavada","__typename":"User","username":"venkat.chadalavada","imageId":"","mediumMemberAt":1561020448000},"$ROOT_QUERY.notificationsConnection({})":{"notifications":[{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).notifications.0","typename":"Notification"},{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).notifications.1","typename":"Notification"}],"pagingInfo":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).pagingInfo","typename":"Paging"},"__typename":"NotificationsConnection"},"$ROOT_QUERY.notificationsConnection({}).pagingInfo.next":{"limit":25,"page":null,"source":null,"to":"1565791760330","__typename":"PageParams"},"$ROOT_QUERY.notificationsConnection({}).pagingInfo":{"next":{"type":"id","generated":true,"id":"$ROOT_QUERY.notificationsConnection({}).pagingInfo.next","typename":"PageParams"},"__typename":"Paging"},"$ROOT_QUERY.notificationStatus":{"unreadNotificationCount":0,"__typename":"NotificationStatus"}}</script><script src="./movie_files/manifest.90ffa4a7.js.download"></script><script src="./movie_files/vendors_main.0ba542c9.chunk.js.download"></script><script src="./movie_files/main.c8bb9bef.chunk.js.download"></script><script src="./movie_files/vendors_screen.collection.packageBuilder_screen.landingpages.pres45_screen.landingpages.tribute_scre_3e410f11.6e718f1d.chunk.js.download"></script>
<script src="./movie_files/screen.collection.packageBuilder_screen.landingpages.pres45_screen.landingpages.tribute_screen.post__73c4bb05.f7138cac.chunk.js.download"></script>
<script src="./movie_files/screen.post_screen.post.amp_screen.post.series_screen.profile_screen.sequence.library_screen.sequenc_036c6b37.0152f652.chunk.js.download"></script>
<script src="./movie_files/screen.collection.packageBuilder_screen.landingpages.pres45_screen.landingpages.tick_screen.landingp_ed90ee39.727c496c.chunk.js.download"></script>
<script src="./movie_files/screen.post.b6d23d53.chunk.js.download"></script><script>window.main();</script><script src="./movie_files/p.js.download" async="" id="parsely-cf"></script><div><div class="n o p xa xb xc xd xe s t qk u v xf" tabindex="-1" aria-modal="true"><div class="wx wy wz"></div></div></div></body></html>